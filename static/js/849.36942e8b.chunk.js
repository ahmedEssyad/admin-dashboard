"use strict";(self.webpackChunkadmin_dashboard=self.webpackChunkadmin_dashboard||[]).push([[849],{21849:(e,r,s)=>{s.r(r),s.d(r,{default:()=>as});var t=s(9950),i=s(28429),n=s(59254),a=s(14857),o=s(88060),l=s(16491),d=s(4447),c=s(46589),u=s(74489),x=s(83239),h=s(25333),m=s(82053),p=s(55660),j=s(41413),A=s(17239),g=s(74745),y=s(23266),f=s(14195),v=s(83563),b=s(73212),w=s(50294),C=s(59086),P=s(83337),S=s(10226),_=s(46639),E=s(249),D=s(32610),k=s(89299),R=s(95699),N=s(99905),I=s(11227),W=s(66387),M=s(95720),q=s(20760),F=s(43974),$=s(28973),B=s(71496),L=s(85923),z=s(44414);const O=()=>{const[e,r]=(0,t.useState)(null),[s,n]=(0,t.useState)([]),[a,o]=(0,t.useState)(0),[c,u]=(0,t.useState)(!1),x=(0,i.Zp)(),j=Boolean(e);(0,t.useEffect)((()=>{y();const e=setInterval(y,3e4);return()=>clearInterval(e)}),[]);const y=async()=>{try{u(!0);const e=await B.A.get("/notifications",{params:{limit:10}});n(e.data.data),o(e.data.unreadCount)}catch(e){console.error("Erreur lors du chargement des notifications:",e)}finally{u(!1)}},b=()=>{r(null)},w=e=>{switch(e){case"info":default:return(0,z.jsx)(k.A,{color:"info"});case"warning":return(0,z.jsx)(R.A,{color:"warning"});case"error":return(0,z.jsx)(N.A,{color:"error"});case"success":return(0,z.jsx)(I.A,{color:"success"})}};return(0,z.jsxs)(z.Fragment,{children:[(0,z.jsx)(p.A,{title:"Notifications",children:(0,z.jsx)(h.A,{color:"inherit",onClick:e=>{r(e.currentTarget)},"aria-label":"notifications",children:(0,z.jsx)(d.A,{badgeContent:a,color:"error",children:(0,z.jsx)(W.A,{})})})}),(0,z.jsxs)(A.A,{anchorEl:e,open:j,onClose:b,PaperProps:{sx:{width:360,maxHeight:500,overflow:"auto"}},transformOrigin:{horizontal:"right",vertical:"top"},anchorOrigin:{horizontal:"right",vertical:"bottom"},children:[(0,z.jsxs)(l.A,{sx:{p:2,display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,z.jsx)(m.A,{variant:"h6",children:"Notifications"}),a>0&&(0,z.jsx)(S.A,{startIcon:(0,z.jsx)(M.A,{}),size:"small",onClick:async()=>{try{await B.A.patch("/notifications/read-all"),n(s.map((e=>({...e,read:!0})))),o(0),L.oR.success("Toutes les notifications ont \xe9t\xe9 marqu\xe9es comme lues")}catch(e){console.error("Erreur lors de la mise \xe0 jour des notifications:",e),L.oR.error("Erreur lors de la mise \xe0 jour des notifications")}},children:"Tout marquer comme lu"})]}),(0,z.jsx)(g.A,{}),c?(0,z.jsx)(l.A,{sx:{p:3,textAlign:"center"},children:(0,z.jsx)(_.A,{size:24})}):0===s.length?(0,z.jsx)(l.A,{sx:{p:3,textAlign:"center"},children:(0,z.jsx)(m.A,{variant:"body2",color:"text.secondary",children:"Aucune notification"})}):(0,z.jsx)(E.A,{sx:{p:0},children:s.map((e=>(0,z.jsxs)(D.Ay,{button:!0,onClick:()=>(async e=>{try{e.read||(await B.A.patch(`/notifications/${e._id}/read`),n(s.map((r=>r._id===e._id?{...r,read:!0}:r))),o((e=>Math.max(0,e-1)))),e.link&&x(e.link),b()}catch(r){console.error("Erreur lors du traitement de la notification:",r),L.oR.error("Erreur lors du traitement de la notification")}})(e),sx:{backgroundColor:e.read?"transparent":"rgba(0, 0, 0, 0.04)","&:hover":{backgroundColor:"rgba(0, 0, 0, 0.08)"}},children:[(0,z.jsx)(f.A,{children:w(e.type)}),(0,z.jsx)(v.A,{primary:e.message,secondary:(0,F.A)(new Date(e.createdAt),"PPP \xe0 p",{locale:$.A}),primaryTypographyProps:{variant:"body2",fontWeight:e.read?"normal":"bold"},secondaryTypographyProps:{variant:"caption"}}),(0,z.jsx)(h.A,{size:"small",edge:"end",onClick:r=>(async(e,r)=>{e.stopPropagation();try{await B.A.delete(`/notifications/${r}`);const e=s.filter((e=>e._id!==r));n(e),L.oR.success("Notification supprim\xe9e")}catch(t){console.error("Erreur lors de la suppression de la notification:",t),L.oR.error("Erreur lors de la suppression de la notification")}})(r,e._id),children:(0,z.jsx)(q.A,{fontSize:"small"})})]},e._id)))}),(0,z.jsx)(g.A,{}),(0,z.jsx)(l.A,{sx:{p:1},children:(0,z.jsx)(S.A,{fullWidth:!0,size:"small",onClick:()=>{b(),x("/admin/settings")},children:"Voir toutes les notifications"})})]})]})};var T=s(43161),U=s(57357),V=s(33738),K=s(39694),G=s(76787),H=s(7523),Y=s(16345),J=s(71471),Q=s(29885),Z=s(72541),X=s(7084),ee=s(64085),re=s(47520),se=s(49238),te=s(95050),ie=s(35834),ne=s(42074);const ae=e=>{let{mobileOpen:r,handleDrawerToggle:s,drawerWidth:n}=e;const o=(0,a.A)(),{currentUser:c,hasPermission:u}=(0,T.A)(),x=(0,i.zy)(),[h,A]=t.useState(null),y=e=>x.pathname===e;t.useEffect((()=>{const e=b.find((e=>e.subItems&&e.subItems.some((e=>y(e.path)))));e&&A(e.id)}),[x.pathname]);const b=[{id:"dashboard",text:"Tableau de bord",icon:(0,z.jsx)(G.A,{}),path:"/admin/dashboard",show:!0,badge:null},{id:"catalog",text:"Catalogue",icon:(0,z.jsx)(H.A,{}),show:u("products","read")&&"orderManager"!==(null===c||void 0===c?void 0:c.role)||u("categories","read")&&"contentEditor"===(null===c||void 0===c?void 0:c.role),subItems:[{id:"products",text:"Produits",icon:(0,z.jsx)(Y.A,{}),path:"/admin/products",show:u("products","read")&&"orderManager"!==(null===c||void 0===c?void 0:c.role),badge:null},{id:"categories",text:"Cat\xe9gories",icon:(0,z.jsx)(J.A,{}),path:"/admin/categories",show:u("categories","read")&&("contentEditor"===(null===c||void 0===c?void 0:c.role)||"superAdmin"===(null===c||void 0===c?void 0:c.role)),badge:null},{id:"subcategories",text:"Sous-cat\xe9gories",icon:(0,z.jsx)(Q.A,{}),path:"/admin/subcategories",show:u("categories","read")&&("contentEditor"===(null===c||void 0===c?void 0:c.role)||"superAdmin"===(null===c||void 0===c?void 0:c.role)),badge:null}]},{id:"companies",text:"Entreprises",icon:(0,z.jsx)(Z.A,{}),path:"/admin/companies",show:u("companies","read")&&("contentEditor"===(null===c||void 0===c?void 0:c.role)||"superAdmin"===(null===c||void 0===c?void 0:c.role)),badge:null},{id:"promotions",text:"Promotions",icon:(0,z.jsx)(X.A,{}),path:"/admin/promotions",show:u("products","update")&&"orderManager"!==(null===c||void 0===c?void 0:c.role),badge:null},{id:"orders",text:"Commandes",icon:(0,z.jsx)(ee.A,{}),path:"/admin/orders",show:u("orders","read")&&"productManager"!==(null===c||void 0===c?void 0:c.role),badge:{count:8,color:"error"}},{id:"statistics",text:"Statistiques",icon:(0,z.jsx)(re.A,{}),path:"/admin/statistics",show:!0,badge:null},{id:"admin-users",text:"Administrateurs",icon:(0,z.jsx)(se.A,{}),path:"/admin/admin-users",show:u("admins","read"),badge:null},{id:"profile",text:"Profil",icon:(0,z.jsx)(w.A,{}),path:"/admin/profile",show:!0,badge:null},{id:"settings",text:"Param\xe8tres",icon:(0,z.jsx)(C.A,{}),path:"/admin/settings",show:!0,badge:null}],P=b.filter((e=>e.show)),S=(0,z.jsxs)("div",{children:[(0,z.jsxs)(l.A,{sx:{py:3,px:2,display:"flex",flexDirection:"column",alignItems:"center",bgcolor:o.palette.primary.main,color:"white"},children:[(0,z.jsx)(j.A,{alt:"Logo",src:"/logo.png",sx:{width:60,height:60,mb:1,bgcolor:"white",p:1}}),(0,z.jsx)(m.A,{variant:"h6",fontWeight:"bold",align:"center",sx:{mb:.5},children:"Admin Dashboard"}),c&&(0,z.jsx)(l.A,{sx:{mt:1,textAlign:"center"},children:(0,z.jsx)(p.A,{title:"Votre r\xf4le",children:(0,z.jsxs)(m.A,{variant:"caption",sx:{backgroundColor:"rgba(255, 255, 255, 0.15)",borderRadius:"12px",py:.5,px:1.5,display:"inline-block",fontWeight:500},children:["superAdmin"===c.role&&"Super Admin","productManager"===c.role&&"Responsable produits","orderManager"===c.role&&"Responsable commandes","contentEditor"===c.role&&"\xc9diteur de contenu"]})})})]}),(0,z.jsx)(g.A,{}),(0,z.jsx)(l.A,{sx:{p:2},children:(0,z.jsx)(E.A,{sx:{px:1},children:P.map((e=>e.subItems?(0,z.jsxs)(t.Fragment,{children:[(0,z.jsx)(D.Ay,{disablePadding:!0,sx:{mb:.5},children:(0,z.jsxs)(U.A,{onClick:()=>{return r=e.id,void A(h===r?null:r);var r},sx:{borderRadius:2,color:h===e.id?o.palette.primary.main:o.palette.text.primary,bgcolor:h===e.id?"rgba(37, 99, 235, 0.08)":"transparent"},children:[(0,z.jsx)(f.A,{sx:{color:h===e.id?o.palette.primary.main:"inherit",minWidth:40},children:e.icon}),(0,z.jsx)(v.A,{primary:e.text}),h===e.id?(0,z.jsx)(te.A,{}):(0,z.jsx)(ie.A,{})]})}),(0,z.jsx)(V.A,{in:h===e.id,timeout:"auto",unmountOnExit:!0,children:(0,z.jsx)(E.A,{component:"div",disablePadding:!0,children:e.subItems.filter((e=>e.show)).map((e=>(0,z.jsx)(D.Ay,{disablePadding:!0,sx:{pl:2,mb:.5},children:(0,z.jsxs)(U.A,{component:ne.k2,to:e.path,sx:{borderRadius:2,pl:2,color:y(e.path)?o.palette.primary.main:o.palette.text.primary,bgcolor:y(e.path)?"rgba(37, 99, 235, 0.08)":"transparent","&:hover":{bgcolor:"rgba(37, 99, 235, 0.12)"}},children:[(0,z.jsx)(f.A,{sx:{color:y(e.path)?o.palette.primary.main:"inherit",minWidth:36},children:e.icon}),(0,z.jsx)(v.A,{primary:e.text,primaryTypographyProps:{fontSize:"0.9rem"}}),e.badge&&(0,z.jsx)(d.A,{badgeContent:e.badge.count,color:e.badge.color})]})},e.id)))})})]},e.id):(0,z.jsx)(D.Ay,{disablePadding:!0,sx:{mb:.5},children:(0,z.jsxs)(U.A,{component:ne.k2,to:e.path,sx:{borderRadius:2,color:y(e.path)?o.palette.primary.main:o.palette.text.primary,bgcolor:y(e.path)?"rgba(37, 99, 235, 0.08)":"transparent","&:hover":{bgcolor:"rgba(37, 99, 235, 0.12)"}},children:[(0,z.jsx)(f.A,{sx:{color:y(e.path)?o.palette.primary.main:"inherit",minWidth:40},children:e.icon}),(0,z.jsx)(v.A,{primary:e.text}),e.badge&&(0,z.jsx)(d.A,{badgeContent:e.badge.count,color:e.badge.color})]})},e.id)))})}),(0,z.jsxs)(l.A,{sx:{mt:"auto",p:2},children:[(0,z.jsx)(g.A,{sx:{mb:2}}),(0,z.jsxs)(m.A,{variant:"caption",color:"text.secondary",sx:{px:2,display:"block"},children:["\xa9 ",(new Date).getFullYear()," Admin Dashboard",(0,z.jsx)("br",{}),"Version 1.0.0"]})]})]});return(0,z.jsxs)(l.A,{component:"nav",sx:{width:{md:n},flexShrink:{md:0}},children:[(0,z.jsx)(K.Ay,{variant:"temporary",open:r,onClose:s,ModalProps:{keepMounted:!0},sx:{display:{xs:"block",md:"none"},"& .MuiDrawer-paper":{boxSizing:"border-box",width:n,boxShadow:"0 10px 30px rgba(0,0,0,0.1)"}},children:S}),(0,z.jsx)(K.Ay,{variant:"permanent",sx:{display:{xs:"none",md:"block"},"& .MuiDrawer-paper":{boxSizing:"border-box",width:n,borderRight:"1px solid rgba(0, 0, 0, 0.05)"}},open:!0,children:S})]})},oe=280,le=(0,n.Ay)(o.A,{shouldForwardProp:e=>"open"!==e})((e=>{let{theme:r,open:s}=e;return{transition:r.transitions.create(["margin","width"],{easing:r.transitions.easing.sharp,duration:r.transitions.duration.leavingScreen}),...s&&{[r.breakpoints.up("md")]:{width:"calc(100% - 280px)",marginLeft:oe}},boxShadow:"none",backdropFilter:"blur(6px)",backgroundColor:"rgba(255, 255, 255, 0.8)",color:r.palette.text.primary,borderBottom:`1px solid ${r.palette.divider}`}})),de=(0,n.Ay)("main",{shouldForwardProp:e=>"open"!==e})((e=>{let{theme:r,open:s}=e;return{flexGrow:1,padding:r.spacing(3),transition:r.transitions.create("margin",{easing:r.transitions.easing.sharp,duration:r.transitions.duration.leavingScreen}),...s&&{[r.breakpoints.up("md")]:{marginLeft:oe},transition:r.transitions.create("margin",{easing:r.transitions.easing.easeOut,duration:r.transitions.duration.enteringScreen})},minHeight:"100vh",display:"flex",flexDirection:"column",backgroundColor:r.palette.background.default}})),ce=(0,n.Ay)(l.A)((e=>{let{theme:r}=e;return{flex:1,width:"100%",maxWidth:"100%",margin:"0 auto",padding:r.spacing(2),[r.breakpoints.up("md")]:{padding:r.spacing(3)}}})),ue=(0,n.Ay)(d.A)((e=>{let{theme:r}=e;return{"& .MuiBadge-badge":{backgroundColor:r.palette.success.main,color:r.palette.success.main,boxShadow:`0 0 0 2px ${r.palette.background.paper}`,"&::after":{position:"absolute",top:0,left:0,width:"100%",height:"100%",borderRadius:"50%",content:'""'}}}})),xe=e=>{let{children:r}=e;const[s,n]=(0,t.useState)(!1),[o,d]=(0,t.useState)(null),{currentUser:S,logout:_}=(0,T.A)(),E=(0,i.Zp)(),D=(0,a.A)(),k=(0,c.A)(D.breakpoints.down("md")),R=()=>{n(!s)},N=()=>{d(null)},I=()=>S?S.firstName&&S.lastName?`${S.firstName} ${S.lastName}`:S.username:"Utilisateur",W=()=>{if(!S)return"";return{superAdmin:"Super Admin",productManager:"Responsable produits",orderManager:"Responsable commandes",contentEditor:"\xc9diteur de contenu"}[S.role]||S.role};return(0,z.jsxs)(l.A,{sx:{display:"flex"},children:[(0,z.jsx)(u.Ay,{}),(0,z.jsx)(le,{position:"fixed",open:!k&&s,children:(0,z.jsxs)(x.A,{children:[(0,z.jsx)(h.A,{color:"inherit","aria-label":"open drawer",edge:"start",onClick:R,sx:{mr:2},children:(0,z.jsx)(b.A,{})}),(0,z.jsx)(m.A,{variant:"h6",noWrap:!0,component:"div",sx:{flexGrow:1},children:"Dashboard Admin"}),(0,z.jsx)(l.A,{sx:{mr:1},children:(0,z.jsx)(O,{})}),(0,z.jsxs)(l.A,{sx:{display:"flex",alignItems:"center"},children:[!k&&(0,z.jsxs)(l.A,{sx:{mr:2,textAlign:"right"},children:[(0,z.jsx)(m.A,{variant:"subtitle2",component:"div",children:I()}),(0,z.jsx)(m.A,{variant:"caption",color:"textSecondary",children:W()})]}),(0,z.jsx)(p.A,{title:"Param\xe8tres du compte",children:(0,z.jsx)(h.A,{size:"large","aria-label":"account of current user","aria-controls":"menu-appbar","aria-haspopup":"true",onClick:e=>{d(e.currentTarget)},color:"inherit",children:(0,z.jsx)(ue,{overlap:"circular",anchorOrigin:{vertical:"bottom",horizontal:"right"},variant:"dot",children:(0,z.jsx)(j.A,{sx:{bgcolor:D.palette.primary.main},children:S?S.firstName&&S.lastName?`${S.firstName.charAt(0)}${S.lastName.charAt(0)}`:S.username.charAt(0).toUpperCase():"U"})})})}),(0,z.jsxs)(A.A,{id:"menu-appbar",anchorEl:o,anchorOrigin:{vertical:"bottom",horizontal:"right"},keepMounted:!0,transformOrigin:{vertical:"top",horizontal:"right"},open:Boolean(o),onClose:N,sx:{"& .MuiPaper-root":{borderRadius:2,minWidth:180,boxShadow:"0px 4px 20px rgba(0,0,0,0.1)"}},children:[(0,z.jsxs)(l.A,{sx:{px:2,py:1.5},children:[(0,z.jsx)(m.A,{variant:"subtitle1",fontWeight:"bold",children:I()}),(0,z.jsx)(m.A,{variant:"body2",color:"textSecondary",children:W()})]}),(0,z.jsx)(g.A,{}),(0,z.jsxs)(y.A,{onClick:()=>{N(),E("/admin/profile")},dense:!0,children:[(0,z.jsx)(f.A,{children:(0,z.jsx)(w.A,{fontSize:"small"})}),(0,z.jsx)(v.A,{children:"Profil"})]}),(0,z.jsxs)(y.A,{onClick:()=>{N(),E("/admin/settings")},dense:!0,children:[(0,z.jsx)(f.A,{children:(0,z.jsx)(C.A,{fontSize:"small"})}),(0,z.jsx)(v.A,{children:"Param\xe8tres"})]}),(0,z.jsx)(g.A,{}),(0,z.jsxs)(y.A,{onClick:()=>{N(),_()},dense:!0,children:[(0,z.jsx)(f.A,{children:(0,z.jsx)(P.A,{fontSize:"small"})}),(0,z.jsx)(v.A,{children:"D\xe9connexion"})]})]})]})]})}),(0,z.jsx)(ae,{mobileOpen:s,handleDrawerToggle:R,drawerWidth:oe}),(0,z.jsxs)(de,{open:!k&&s,children:[(0,z.jsx)(x.A,{})," ",(0,z.jsx)(ce,{children:r})]})]})};var he=s(19808),me=s(2235),pe=s(33174),je=s(29925),Ae=s(77078),ge=s(43939),ye=s(29714);const fe=ye.Ik({username:ye.Yj().required("Le nom d'utilisateur est requis"),password:ye.Yj().required("Le mot de passe est requis")});const ve=function(){var e,r;const[s,n]=(0,t.useState)(""),{login:a}=(0,T.A)(),o=(0,i.Zp)(),d=(null===(e=(0,i.zy)().state)||void 0===e||null===(r=e.from)||void 0===r?void 0:r.pathname)||"/admin/dashboard",c=(0,ge.Wx)({initialValues:{username:"",password:""},validationSchema:fe,onSubmit:async e=>{try{await a(e.username,e.password)?o(d,{replace:!0}):n("Nom d'utilisateur ou mot de passe incorrect.")}catch(r){n("Une erreur est survenue lors de la connexion.")}}});return(0,z.jsx)(he.A,{component:"main",maxWidth:"xs",children:(0,z.jsx)(l.A,{sx:{marginTop:8,display:"flex",flexDirection:"column",alignItems:"center"},children:(0,z.jsx)(me.A,{elevation:3,sx:{padding:4,width:"100%"},children:(0,z.jsxs)(l.A,{sx:{display:"flex",flexDirection:"column",alignItems:"center"},children:[(0,z.jsx)(j.A,{sx:{m:1,bgcolor:"primary.main"},children:(0,z.jsx)(Ae.A,{})}),(0,z.jsx)(m.A,{component:"h1",variant:"h5",children:"Connexion Admin"}),s&&(0,z.jsx)(pe.A,{severity:"error",sx:{mt:2,width:"100%"},children:s}),(0,z.jsxs)(l.A,{component:"form",onSubmit:c.handleSubmit,sx:{mt:1,width:"100%"},children:[(0,z.jsx)(je.A,{margin:"normal",required:!0,fullWidth:!0,id:"username",label:"Nom d'utilisateur",name:"username",autoComplete:"username",autoFocus:!0,value:c.values.username,onChange:c.handleChange,error:c.touched.username&&Boolean(c.errors.username),helperText:c.touched.username&&c.errors.username}),(0,z.jsx)(je.A,{margin:"normal",required:!0,fullWidth:!0,name:"password",label:"Mot de passe",type:"password",id:"password",autoComplete:"current-password",value:c.values.password,onChange:c.handleChange,error:c.touched.password&&Boolean(c.errors.password),helperText:c.touched.password&&c.errors.password}),(0,z.jsx)(S.A,{type:"submit",fullWidth:!0,variant:"contained",sx:{mt:3,mb:2},disabled:c.isSubmitting,children:"Se connecter"})]})]})})})})};var be=s(60899),we=s(18274);const Ce=function(){const[e,r]=(0,t.useState)(null),[s,i]=(0,t.useState)(!0),[n,a]=(0,t.useState)("");return(0,t.useEffect)((()=>{(async()=>{try{const e=await B.A.get("/stats");r(e.data),i(!1)}catch(e){console.error("Erreur lors du chargement des statistiques:",e),a("Impossible de charger les statistiques."),i(!1)}})()}),[]),s?(0,z.jsx)(l.A,{sx:{display:"flex",justifyContent:"center",mt:4},children:(0,z.jsx)(_.A,{})}):n?(0,z.jsx)(l.A,{sx:{mt:4},children:(0,z.jsx)(m.A,{color:"error",variant:"h6",children:n})}):(0,z.jsxs)("div",{children:[(0,z.jsx)(m.A,{variant:"h4",gutterBottom:!0,children:"Tableau de bord"}),(0,z.jsxs)(be.Ay,{container:!0,spacing:3,children:[(0,z.jsx)(be.Ay,{item:!0,xs:12,sm:4,children:(0,z.jsxs)(me.A,{sx:{p:3,display:"flex",flexDirection:"column",alignItems:"center",bgcolor:"primary.light",color:"white"},children:[(0,z.jsx)(J.A,{sx:{fontSize:60,mb:2}}),(0,z.jsx)(m.A,{variant:"h4",children:(null===e||void 0===e?void 0:e.categories)||0}),(0,z.jsx)(m.A,{variant:"h6",children:"Cat\xe9gories"})]})}),(0,z.jsx)(be.Ay,{item:!0,xs:12,sm:4,children:(0,z.jsxs)(me.A,{sx:{p:3,display:"flex",flexDirection:"column",alignItems:"center",bgcolor:"secondary.light",color:"white"},children:[(0,z.jsx)(ee.A,{sx:{fontSize:60,mb:2}}),(0,z.jsx)(m.A,{variant:"h4",children:(null===e||void 0===e?void 0:e.products)||0}),(0,z.jsx)(m.A,{variant:"h6",children:"Produits"})]})}),(0,z.jsx)(be.Ay,{item:!0,xs:12,sm:4,children:(0,z.jsxs)(me.A,{sx:{p:3,display:"flex",flexDirection:"column",alignItems:"center",bgcolor:"success.light",color:"white"},children:[(0,z.jsx)(we.A,{sx:{fontSize:60,mb:2}}),(0,z.jsx)(m.A,{variant:"h4",children:(null===e||void 0===e?void 0:e.companies)||0}),(0,z.jsx)(m.A,{variant:"h6",children:"Entreprises"})]})})]}),(0,z.jsxs)(l.A,{mt:4,children:[(0,z.jsx)(m.A,{variant:"h5",gutterBottom:!0,children:"Bienvenue dans votre panneau d'administration"}),(0,z.jsx)(m.A,{variant:"body1",children:"Utilisez le menu \xe0 gauche pour g\xe9rer votre catalogue de produits, cat\xe9gories et entreprises."})]})]})};var Pe=s(1320),Se=s(15769),_e=s(69780),Ee=s(9213),De=s(21671),ke=s(34075),Re=s(96583),Ne=s(40033),Ie=s(28170),We=s(79739),Me=s(53256),qe=s(40379),Fe=s(6493);const $e=function(e){let{open:r,title:s,message:t,onConfirm:i,onCancel:n}=e;return(0,z.jsxs)(Re.A,{open:r,onClose:n,"aria-labelledby":"confirm-dialog-title","aria-describedby":"confirm-dialog-description",children:[(0,z.jsx)(Ne.A,{id:"confirm-dialog-title",children:s}),(0,z.jsx)(Ie.A,{children:(0,z.jsx)(Fe.A,{id:"confirm-dialog-description",children:t})}),(0,z.jsxs)(We.A,{children:[(0,z.jsx)(S.A,{onClick:n,color:"primary",children:"Annuler"}),(0,z.jsx)(S.A,{onClick:i,color:"error",autoFocus:!0,children:"Confirmer"})]})]})};const Be=function(e){let{src:r,alt:s,onDelete:t}=e;return(0,z.jsx)(l.A,{sx:{position:"relative",width:150,height:150,display:"inline-block",m:1,border:"1px solid #ddd",borderRadius:1,overflow:"hidden"},children:r?(0,z.jsxs)(z.Fragment,{children:[(0,z.jsx)("img",{src:r,alt:s||"Aper\xe7u",style:{width:"100%",height:"100%",objectFit:"cover"}}),t&&(0,z.jsx)(h.A,{size:"small",sx:{position:"absolute",top:5,right:5,bgcolor:"rgba(255, 255, 255, 0.7)","&:hover":{bgcolor:"rgba(255, 255, 255, 0.9)"}},onClick:t,children:(0,z.jsx)(q.A,{color:"error"})})]}):(0,z.jsx)(m.A,{variant:"body2",sx:{display:"flex",alignItems:"center",justifyContent:"center",height:"100%",color:"text.secondary"},children:"Aucune image"})})};const Le=function(){const[e,r]=(0,t.useState)([]),[s,i]=(0,t.useState)(!0),[n,a]=(0,t.useState)(!1),[o,d]=(0,t.useState)({name:"",description:""}),[c,u]=(0,t.useState)(null),[x,p]=(0,t.useState)(""),[j,A]=(0,t.useState)(!1),[g,y]=(0,t.useState)(null),[f,v]=(0,t.useState)({open:!1,id:null});(0,t.useEffect)((()=>{b()}),[]);const b=async()=>{try{i(!0);const e=await B.A.get("/categories");r(e.data),i(!1)}catch(e){console.error("Erreur lors du chargement des cat\xe9gories:",e),L.oR.error("Impossible de charger les cat\xe9gories"),i(!1)}},w=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;e?(d({name:e.name,description:e.description||""}),p(e.logo||""),A(!0),y(e._id)):(d({name:"",description:""}),u(null),p(""),A(!1),y(null)),a(!0)},C=()=>{a(!1),d({name:"",description:""}),u(null),p("")},P=e=>{const{name:r,value:s}=e.target;d({...o,[r]:s})};return s?(0,z.jsx)(l.A,{sx:{display:"flex",justifyContent:"center",mt:4},children:(0,z.jsx)(_.A,{})}):(0,z.jsxs)("div",{children:[(0,z.jsxs)(l.A,{sx:{display:"flex",justifyContent:"space-between",mb:3},children:[(0,z.jsx)(m.A,{variant:"h4",children:"Gestion des Cat\xe9gories"}),(0,z.jsx)(S.A,{variant:"contained",startIcon:(0,z.jsx)(Me.A,{}),onClick:()=>w(),children:"Ajouter une cat\xe9gorie"})]}),(0,z.jsx)(Pe.A,{component:me.A,children:(0,z.jsxs)(Se.A,{children:[(0,z.jsx)(_e.A,{children:(0,z.jsxs)(Ee.A,{children:[(0,z.jsx)(De.A,{children:"Image"}),(0,z.jsx)(De.A,{children:"Nom"}),(0,z.jsx)(De.A,{children:"Description"}),(0,z.jsx)(De.A,{children:"Actions"})]})}),(0,z.jsx)(ke.A,{children:e.length>0?e.map((e=>(0,z.jsxs)(Ee.A,{children:[(0,z.jsx)(De.A,{children:(0,z.jsx)(l.A,{sx:{width:60,height:60},children:e.logo?(0,z.jsx)("img",{src:e.logo,alt:e.name,style:{width:"100%",height:"100%",objectFit:"cover",borderRadius:"4px"}}):(0,z.jsx)(l.A,{sx:{width:"100%",height:"100%",bgcolor:"grey.200",display:"flex",alignItems:"center",justifyContent:"center",borderRadius:"4px"},children:(0,z.jsx)(m.A,{variant:"caption",children:"No image"})})})}),(0,z.jsx)(De.A,{children:e.name}),(0,z.jsx)(De.A,{children:e.description||"-"}),(0,z.jsxs)(De.A,{children:[(0,z.jsx)(h.A,{onClick:()=>w(e),children:(0,z.jsx)(qe.A,{})}),(0,z.jsx)(h.A,{onClick:()=>{return r=e._id,void v({open:!0,id:r});var r},children:(0,z.jsx)(q.A,{color:"error"})})]})]},e._id))):(0,z.jsx)(Ee.A,{children:(0,z.jsx)(De.A,{colSpan:4,align:"center",children:"Aucune cat\xe9gorie trouv\xe9e"})})})]})}),(0,z.jsxs)(Re.A,{open:n,onClose:C,children:[(0,z.jsx)(Ne.A,{children:j?"Modifier la cat\xe9gorie":"Ajouter une cat\xe9gorie"}),(0,z.jsx)(Ie.A,{children:(0,z.jsxs)(be.Ay,{container:!0,spacing:2,sx:{mt:1},children:[(0,z.jsx)(be.Ay,{item:!0,xs:12,children:(0,z.jsx)(je.A,{name:"name",label:"Nom",fullWidth:!0,value:o.name,onChange:P,required:!0})}),(0,z.jsx)(be.Ay,{item:!0,xs:12,children:(0,z.jsx)(je.A,{name:"description",label:"Description",fullWidth:!0,multiline:!0,rows:3,value:o.description,onChange:P})}),(0,z.jsxs)(be.Ay,{item:!0,xs:12,children:[(0,z.jsx)("input",{accept:"image/*",style:{display:"none"},id:"logo-upload",type:"file",onChange:e=>{e.target.files&&e.target.files[0]&&(u(e.target.files[0]),p(URL.createObjectURL(e.target.files[0])))}}),(0,z.jsx)("label",{htmlFor:"logo-upload",children:(0,z.jsx)(S.A,{variant:"outlined",component:"span",children:j?"Changer l'image":"Ajouter une image"})}),(0,z.jsx)(l.A,{sx:{mt:2},children:x&&(0,z.jsx)(Be,{src:x,alt:"Aper\xe7u de l'image",onDelete:()=>{u(null),p("")}})})]})]})}),(0,z.jsxs)(We.A,{children:[(0,z.jsx)(S.A,{onClick:C,children:"Annuler"}),(0,z.jsx)(S.A,{onClick:async()=>{try{const e=new FormData;e.append("name",o.name),e.append("description",o.description),c&&e.append("logo",c),j?(await B.A.put(`/categories/${g}`,e),L.oR.success("Cat\xe9gorie mise \xe0 jour avec succ\xe8s")):(await B.A.post("/categories",e),L.oR.success("Cat\xe9gorie cr\xe9\xe9e avec succ\xe8s")),C(),b()}catch(e){console.error("Erreur lors de l'enregistrement de la cat\xe9gorie:",e),L.oR.error("Erreur lors de l'enregistrement de la cat\xe9gorie")}},variant:"contained",disabled:!o.name,children:j?"Mettre \xe0 jour":"Ajouter"})]})]}),(0,z.jsx)($e,{open:f.open,title:"Confirmer la suppression",message:"\xcates-vous s\xfbr de vouloir supprimer cette cat\xe9gorie? Cette action est irr\xe9versible.",onConfirm:async()=>{try{await B.A.delete(`/categories/${f.id}`),L.oR.success("Cat\xe9gorie supprim\xe9e avec succ\xe8s"),b()}catch(e){console.error("Erreur lors de la suppression de la cat\xe9gorie:",e),L.oR.error("Erreur lors de la suppression de la cat\xe9gorie")}finally{v({open:!1,id:null})}},onCancel:()=>v({open:!1,id:null})})]})};const ze=function(){const[e,r]=(0,t.useState)([]),[s,i]=(0,t.useState)([]),[n,a]=(0,t.useState)(!0),[o,d]=(0,t.useState)(!1),[c,u]=(0,t.useState)({name:"",categories_id:""}),[x,p]=(0,t.useState)(!1),[j,A]=(0,t.useState)(null),[g,f]=(0,t.useState)({open:!1,id:null});(0,t.useEffect)((()=>{v(),b()}),[]);const v=async()=>{try{const e=await B.A.get("/subcategories");r(e.data),a(!1)}catch(e){console.error("Erreur lors du chargement des sous-cat\xe9gories:",e),L.oR.error("Impossible de charger les sous-cat\xe9gories"),a(!1)}},b=async()=>{try{const e=await B.A.get("/categories");i(e.data)}catch(e){console.error("Erreur lors du chargement des cat\xe9gories:",e),L.oR.error("Impossible de charger les cat\xe9gories")}},w=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;e?(u({name:e.name,categories_id:e.categories_id._id||e.categories_id}),p(!0),A(e._id)):(u({name:"",categories_id:""}),p(!1),A(null)),d(!0)},C=()=>{d(!1),u({name:"",categories_id:""})},P=e=>{const{name:r,value:s}=e.target;u({...c,[r]:s})};return n?(0,z.jsx)(l.A,{sx:{display:"flex",justifyContent:"center",mt:4},children:(0,z.jsx)(_.A,{})}):(0,z.jsxs)("div",{children:[(0,z.jsxs)(l.A,{sx:{display:"flex",justifyContent:"space-between",mb:3},children:[(0,z.jsx)(m.A,{variant:"h4",children:"Gestion des Sous-cat\xe9gories"}),(0,z.jsx)(S.A,{variant:"contained",startIcon:(0,z.jsx)(Me.A,{}),onClick:()=>w(),children:"Ajouter une sous-cat\xe9gorie"})]}),(0,z.jsx)(Pe.A,{component:me.A,children:(0,z.jsxs)(Se.A,{children:[(0,z.jsx)(_e.A,{children:(0,z.jsxs)(Ee.A,{children:[(0,z.jsx)(De.A,{children:"Nom"}),(0,z.jsx)(De.A,{children:"Cat\xe9gorie Parente"}),(0,z.jsx)(De.A,{children:"Actions"})]})}),(0,z.jsx)(ke.A,{children:e.length>0?e.map((e=>(0,z.jsxs)(Ee.A,{children:[(0,z.jsx)(De.A,{children:e.name}),(0,z.jsx)(De.A,{children:e.categories_id&&e.categories_id.name?e.categories_id.name:"Non sp\xe9cifi\xe9"}),(0,z.jsxs)(De.A,{children:[(0,z.jsx)(h.A,{onClick:()=>w(e),children:(0,z.jsx)(qe.A,{})}),(0,z.jsx)(h.A,{onClick:()=>{return r=e._id,void f({open:!0,id:r});var r},children:(0,z.jsx)(q.A,{color:"error"})})]})]},e._id))):(0,z.jsx)(Ee.A,{children:(0,z.jsx)(De.A,{colSpan:3,align:"center",children:"Aucune sous-cat\xe9gorie trouv\xe9e"})})})]})}),(0,z.jsxs)(Re.A,{open:o,onClose:C,children:[(0,z.jsx)(Ne.A,{children:x?"Modifier la sous-cat\xe9gorie":"Ajouter une sous-cat\xe9gorie"}),(0,z.jsx)(Ie.A,{children:(0,z.jsxs)(be.Ay,{container:!0,spacing:2,sx:{mt:1},children:[(0,z.jsx)(be.Ay,{item:!0,xs:12,children:(0,z.jsx)(je.A,{name:"name",label:"Nom",fullWidth:!0,value:c.name,onChange:P,required:!0})}),(0,z.jsx)(be.Ay,{item:!0,xs:12,children:(0,z.jsx)(je.A,{select:!0,name:"categories_id",label:"Cat\xe9gorie parente",fullWidth:!0,value:c.categories_id,onChange:P,required:!0,children:s.map((e=>(0,z.jsx)(y.A,{value:e._id,children:e.name},e._id)))})})]})}),(0,z.jsxs)(We.A,{children:[(0,z.jsx)(S.A,{onClick:C,children:"Annuler"}),(0,z.jsx)(S.A,{onClick:async()=>{try{x?(await B.A.put(`/subcategories/${j}`,c),L.oR.success("Sous-cat\xe9gorie mise \xe0 jour avec succ\xe8s")):(await B.A.post("/subcategories",c),L.oR.success("Sous-cat\xe9gorie cr\xe9\xe9e avec succ\xe8s")),C(),v()}catch(e){console.error("Erreur lors de l'enregistrement de la sous-cat\xe9gorie:",e),L.oR.error("Erreur lors de l'enregistrement de la sous-cat\xe9gorie")}},variant:"contained",disabled:!c.name||!c.categories_id,children:x?"Mettre \xe0 jour":"Ajouter"})]})]}),(0,z.jsx)($e,{open:g.open,title:"Confirmer la suppression",message:"\xcates-vous s\xfbr de vouloir supprimer cette sous-cat\xe9gorie? Cette action est irr\xe9versible.",onConfirm:async()=>{try{await B.A.delete(`/subcategories/${g.id}`),L.oR.success("Sous-cat\xe9gorie supprim\xe9e avec succ\xe8s"),v()}catch(e){console.error("Erreur lors de la suppression de la sous-cat\xe9gorie:",e),L.oR.error("Erreur lors de la suppression de la sous-cat\xe9gorie")}finally{f({open:!1,id:null})}},onCancel:()=>f({open:!1,id:null})})]})};var Oe=s(25277),Te=s(25979),Ue=s(3788),Ve=s(16101),Ke=s(3198);const Ge=function(){const[e,r]=(0,t.useState)([]),[s,i]=(0,t.useState)([]),[n,a]=(0,t.useState)([]),[o,d]=(0,t.useState)(!0),[c,u]=(0,t.useState)(!1),[x,p]=(0,t.useState)({nom:"",categories_id:[],subcategories_id:[]}),[j,A]=(0,t.useState)(null),[g,f]=(0,t.useState)(""),[v,b]=(0,t.useState)(!1),[w,C]=(0,t.useState)(null),[P,E]=(0,t.useState)({open:!1,id:null}),[D,k]=(0,t.useState)([]);(0,t.useEffect)((()=>{R(),N(),I()}),[]),(0,t.useEffect)((()=>{if(x.categories_id&&x.categories_id.length>0){const e=n.filter((e=>{var r;if(!e||!e.categories_id)return!1;const s="object"===typeof e.categories_id?null===(r=e.categories_id)||void 0===r?void 0:r._id:e.categories_id;return s&&x.categories_id.includes(s)}));k(e)}else k([])}),[x.categories_id,n]);const R=async()=>{try{const e=await B.A.get("/companies");r(e.data),d(!1)}catch(e){console.error("Erreur lors du chargement des entreprises:",e),L.oR.error("Impossible de charger les entreprises"),d(!1)}},N=async()=>{try{const e=await B.A.get("/categories");i(e.data)}catch(e){console.error("Erreur lors du chargement des cat\xe9gories:",e),L.oR.error("Impossible de charger les cat\xe9gories")}},I=async()=>{try{const e=await B.A.get("/subcategories");a(e.data)}catch(e){console.error("Erreur lors du chargement des sous-cat\xe9gories:",e),L.oR.error("Impossible de charger les sous-cat\xe9gories")}},W=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;if(e){const r=e.categories_id.map((e=>"object"===typeof e?e._id:e)),s=e.subcategories_id.map((e=>"object"===typeof e?e._id:e));p({nom:e.nom,categories_id:r,subcategories_id:s}),f(e.logo||""),b(!0),C(e._id)}else p({nom:"",categories_id:[],subcategories_id:[]}),A(null),f(""),b(!1),C(null);u(!0)},M=()=>{u(!1),p({nom:"",categories_id:[],subcategories_id:[]}),A(null),f("")},F=e=>{const{name:r,value:s}=e.target;p({...x,[r]:s})};return o?(0,z.jsx)(l.A,{sx:{display:"flex",justifyContent:"center",mt:4},children:(0,z.jsx)(_.A,{})}):(0,z.jsxs)("div",{children:[(0,z.jsxs)(l.A,{sx:{display:"flex",justifyContent:"space-between",mb:3},children:[(0,z.jsx)(m.A,{variant:"h4",children:"Gestion des Entreprises"}),(0,z.jsx)(S.A,{variant:"contained",startIcon:(0,z.jsx)(Me.A,{}),onClick:()=>W(),children:"Ajouter une entreprise"})]}),(0,z.jsx)(Pe.A,{component:me.A,children:(0,z.jsxs)(Se.A,{children:[(0,z.jsx)(_e.A,{children:(0,z.jsxs)(Ee.A,{children:[(0,z.jsx)(De.A,{children:"Logo"}),(0,z.jsx)(De.A,{children:"Nom"}),(0,z.jsx)(De.A,{children:"Cat\xe9gories"}),(0,z.jsx)(De.A,{children:"Sous-cat\xe9gories"}),(0,z.jsx)(De.A,{children:"Actions"})]})}),(0,z.jsx)(ke.A,{children:e.length>0?e.map((e=>(0,z.jsxs)(Ee.A,{children:[(0,z.jsx)(De.A,{children:(0,z.jsx)(l.A,{sx:{width:60,height:60},children:e.logo?(0,z.jsx)("img",{src:e.logo,alt:e.nom,style:{width:"100%",height:"100%",objectFit:"cover",borderRadius:"4px"}}):(0,z.jsx)(l.A,{sx:{width:"100%",height:"100%",bgcolor:"grey.200",display:"flex",alignItems:"center",justifyContent:"center",borderRadius:"4px"},children:(0,z.jsx)(m.A,{variant:"caption",children:"No logo"})})})}),(0,z.jsx)(De.A,{children:e.nom}),(0,z.jsx)(De.A,{children:(0,z.jsx)(l.A,{sx:{display:"flex",flexWrap:"wrap",gap:.5},children:e.categories_id.map((e=>(0,z.jsx)(Oe.A,{label:e.name,size:"small",color:"primary",variant:"outlined"},e._id)))})}),(0,z.jsx)(De.A,{children:(0,z.jsx)(l.A,{sx:{display:"flex",flexWrap:"wrap",gap:.5},children:e.subcategories_id.map((e=>(0,z.jsx)(Oe.A,{label:e.name,size:"small",color:"secondary",variant:"outlined"},e._id)))})}),(0,z.jsxs)(De.A,{children:[(0,z.jsx)(h.A,{onClick:()=>W(e),children:(0,z.jsx)(qe.A,{})}),(0,z.jsx)(h.A,{onClick:()=>{return r=e._id,void E({open:!0,id:r});var r},children:(0,z.jsx)(q.A,{color:"error"})})]})]},e._id))):(0,z.jsx)(Ee.A,{children:(0,z.jsx)(De.A,{colSpan:5,align:"center",children:"Aucune entreprise trouv\xe9e"})})})]})}),(0,z.jsxs)(Re.A,{open:c,onClose:M,maxWidth:"md",fullWidth:!0,children:[(0,z.jsx)(Ne.A,{children:v?"Modifier l'entreprise":"Ajouter une entreprise"}),(0,z.jsx)(Ie.A,{children:(0,z.jsxs)(be.Ay,{container:!0,spacing:2,sx:{mt:1},children:[(0,z.jsx)(be.Ay,{item:!0,xs:12,children:(0,z.jsx)(je.A,{name:"nom",label:"Nom de l'entreprise",fullWidth:!0,value:x.nom,onChange:F,required:!0})}),(0,z.jsx)(be.Ay,{item:!0,xs:12,children:(0,z.jsxs)(Te.A,{fullWidth:!0,children:[(0,z.jsx)(Ue.A,{id:"categories-label",children:"Cat\xe9gories"}),(0,z.jsx)(Ve.A,{labelId:"categories-label",multiple:!0,name:"categories_id",value:x.categories_id,onChange:F,input:(0,z.jsx)(Ke.A,{label:"Cat\xe9gories"}),renderValue:e=>(0,z.jsx)(l.A,{sx:{display:"flex",flexWrap:"wrap",gap:.5},children:e.map((e=>{const r=s.find((r=>r._id===e));return r?(0,z.jsx)(Oe.A,{label:r.name},e):null}))}),children:s.map((e=>(0,z.jsx)(y.A,{value:e._id,children:e.name},e._id)))})]})}),(0,z.jsx)(be.Ay,{item:!0,xs:12,children:(0,z.jsxs)(Te.A,{fullWidth:!0,children:[(0,z.jsx)(Ue.A,{id:"subcategories-label",children:"Sous-cat\xe9gories"}),(0,z.jsx)(Ve.A,{labelId:"subcategories-label",multiple:!0,name:"subcategories_id",value:x.subcategories_id,onChange:F,input:(0,z.jsx)(Ke.A,{label:"Sous-cat\xe9gories"}),renderValue:e=>(0,z.jsx)(l.A,{sx:{display:"flex",flexWrap:"wrap",gap:.5},children:e.map((e=>{const r=n.find((r=>r._id===e));return r?(0,z.jsx)(Oe.A,{label:r.name},e):null}))}),disabled:0===x.categories_id.length,children:D.map((e=>(0,z.jsx)(y.A,{value:e._id,children:e.name},e._id)))})]})}),(0,z.jsxs)(be.Ay,{item:!0,xs:12,children:[(0,z.jsx)("input",{accept:"image/*",style:{display:"none"},id:"logo-upload",type:"file",onChange:e=>{e.target.files&&e.target.files[0]&&(A(e.target.files[0]),f(URL.createObjectURL(e.target.files[0])))}}),(0,z.jsx)("label",{htmlFor:"logo-upload",children:(0,z.jsx)(S.A,{variant:"outlined",component:"span",children:v?"Changer le logo":"Ajouter un logo"})}),(0,z.jsx)(l.A,{sx:{mt:2},children:g&&(0,z.jsx)(Be,{src:g,alt:"Aper\xe7u du logo",onDelete:()=>{A(null),f("")}})})]})]})}),(0,z.jsxs)(We.A,{children:[(0,z.jsx)(S.A,{onClick:M,children:"Annuler"}),(0,z.jsx)(S.A,{onClick:async()=>{try{const e=new FormData;e.append("nom",x.nom),x.categories_id.forEach((r=>{e.append("categories_id",r)})),x.subcategories_id.forEach((r=>{e.append("subcategories_id",r)})),j&&e.append("logo",j),v?(await B.A.put(`/companies/${w}`,e),L.oR.success("Entreprise mise \xe0 jour avec succ\xe8s")):(await B.A.post("/companies",e),L.oR.success("Entreprise cr\xe9\xe9e avec succ\xe8s")),M(),R()}catch(e){console.error("Erreur lors de l'enregistrement de l'entreprise:",e),L.oR.error("Erreur lors de l'enregistrement de l'entreprise")}},variant:"contained",disabled:!x.nom||0===x.categories_id.length,children:v?"Mettre \xe0 jour":"Ajouter"})]})]}),(0,z.jsx)($e,{open:P.open,title:"Confirmer la suppression",message:"\xcates-vous s\xfbr de vouloir supprimer cette entreprise? Cette action est irr\xe9versible.",onConfirm:async()=>{try{await B.A.delete(`/companies/${P.id}`),L.oR.success("Entreprise supprim\xe9e avec succ\xe8s"),R()}catch(e){console.error("Erreur lors de la suppression de l'entreprise:",e),L.oR.error("Erreur lors de la suppression de l'entreprise")}finally{E({open:!1,id:null})}},onCancel:()=>E({open:!1,id:null})})]})};var He=s(48089),Ye=s(13569),Je=s(50704),Qe=s(82825),Ze=s(2046),Xe=s(43315),er=s(76812);const rr=function(){const[e,r]=(0,t.useState)([]),[s,i]=(0,t.useState)([]),[n,a]=(0,t.useState)([]),[o,d]=(0,t.useState)([]),[c,u]=(0,t.useState)(!0),[x,j]=(0,t.useState)(!1),[A,g]=(0,t.useState)(!1),[f,v]=(0,t.useState)(!1),[b,w]=(0,t.useState)({nom:"",description:"",features:"",oldPrice:"",quantite:"0",Company_id:"",categoriesa_id:[],subcategories_id:[]}),[C,P]=(0,t.useState)({discountedPrice:"",discountDuration:""}),[E,D]=(0,t.useState)([]),[k,R]=(0,t.useState)([]),[N,I]=(0,t.useState)(!1),[W,M]=(0,t.useState)(null),[$,O]=(0,t.useState)({open:!1,id:null}),[T,U]=(0,t.useState)({open:!1,id:null}),[V,K]=(0,t.useState)(1),[G]=(0,t.useState)(5),[H,Y]=(0,t.useState)(1),[J,Q]=(0,t.useState)([]),[Z,ee]=(0,t.useState)(null);(0,t.useEffect)((()=>{re(),se(),te(),ie()}),[V]),(0,t.useEffect)((()=>{if(b.categoriesa_id&&b.categoriesa_id.length>0){const e=n.filter((e=>{var r;const s=(null===(r=e.categories_id)||void 0===r?void 0:r._id)||e.categories_id;return s&&b.categoriesa_id.includes(s)}));Q(e)}else Q([])}),[b.categoriesa_id,n]);const re=async()=>{try{u(!0);const e=await B.A.get("/products");r(e.data),Y(Math.ceil(e.data.length/G)),u(!1)}catch(e){console.error("Erreur lors du chargement des produits:",e),L.oR.error("Impossible de charger les produits"),u(!1)}},se=async()=>{try{const e=await B.A.get("/categories");i(e.data)}catch(e){console.error("Erreur lors du chargement des cat\xe9gories:",e),L.oR.error("Impossible de charger les cat\xe9gories")}},te=async()=>{try{const e=await B.A.get("/subcategories");a(e.data)}catch(e){console.error("Erreur lors du chargement des sous-cat\xe9gories:",e),L.oR.error("Impossible de charger les sous-cat\xe9gories")}},ie=async()=>{try{const e=await B.A.get("/companies");d(e.data)}catch(e){console.error("Erreur lors du chargement des entreprises:",e),L.oR.error("Impossible de charger les entreprises")}},ne=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;if(e){const r=e.categoriesa_id.map((e=>"object"===typeof e?e._id:e)),s=e.subcategories_id.map((e=>"object"===typeof e?e._id:e));w({nom:e.nom,description:e.description||"",features:e.features||"",oldPrice:e.oldPrice.toString(),quantite:e.quantite.toString(),Company_id:e.Company_id._id||e.Company_id,categoriesa_id:r,subcategories_id:s}),R(e.pictures||[]),I(!0),M(e._id)}else w({nom:"",description:"",features:"",oldPrice:"",quantite:"0",Company_id:"",categoriesa_id:[],subcategories_id:[]}),D([]),R([]),I(!1),M(null);j(!0)},ae=()=>{j(!1),w({nom:"",description:"",features:"",oldPrice:"",quantite:"0",Company_id:"",categoriesa_id:[],subcategories_id:[]}),D([]),R([])},oe=()=>{g(!1),P({discountedPrice:"",discountDuration:""})},le=()=>{v(!1),ee(null),D([])},de=e=>{const{name:r,value:s}=e.target;w({...b,[r]:s})},ce=e=>{const{name:r,value:s}=e.target;P({...C,[r]:s})},ue=e=>{if(e.target.files){const r=Array.from(e.target.files);D([...E,...r]);const s=r.map((e=>URL.createObjectURL(e)));R([...k,...s])}},xe=e.slice((V-1)*G,V*G);return c?(0,z.jsx)(l.A,{sx:{display:"flex",justifyContent:"center",mt:4},children:(0,z.jsx)(_.A,{})}):(0,z.jsxs)("div",{children:[(0,z.jsxs)(l.A,{sx:{display:"flex",justifyContent:"space-between",mb:3},children:[(0,z.jsx)(m.A,{variant:"h4",children:"Gestion des Produits"}),(0,z.jsx)(S.A,{variant:"contained",startIcon:(0,z.jsx)(Me.A,{}),onClick:()=>ne(),children:"Ajouter un produit"})]}),(0,z.jsx)(be.Ay,{container:!0,spacing:3,children:xe.length>0?xe.map((e=>{var r,s,t,i;return(0,z.jsx)(be.Ay,{item:!0,xs:12,sm:6,md:4,children:(0,z.jsxs)(He.A,{sx:{height:"100%",display:"flex",flexDirection:"column"},children:[(0,z.jsx)(Ye.A,{component:"img",height:"140",image:e.mainPicture||"/placeholder-image.jpg",alt:e.nom}),(0,z.jsxs)(Je.A,{sx:{flexGrow:1},children:[(0,z.jsx)(m.A,{gutterBottom:!0,variant:"h6",component:"div",children:e.nom}),(0,z.jsxs)(m.A,{variant:"body2",color:"text.secondary",sx:{mb:1},children:[null===(r=e.description)||void 0===r?void 0:r.substring(0,100),(null===(s=e.description)||void 0===s?void 0:s.length)>100?"...":""]}),(0,z.jsxs)(be.Ay,{container:!0,spacing:1,children:[(0,z.jsx)(be.Ay,{item:!0,xs:6,children:(0,z.jsxs)(m.A,{variant:"body2",children:[(0,z.jsx)("strong",{children:"Prix:"})," ",e.oldPrice," \u20ac"]})}),(0,z.jsx)(be.Ay,{item:!0,xs:6,children:(0,z.jsxs)(m.A,{variant:"body2",children:[(0,z.jsx)("strong",{children:"Stock:"})," ",e.quantite]})}),e.discountedPrice&&(0,z.jsx)(be.Ay,{item:!0,xs:12,children:(0,z.jsxs)(m.A,{variant:"body2",color:"error",children:[(0,z.jsx)("strong",{children:"Prix r\xe9duit:"})," ",e.discountedPrice," \u20ac",e.discountDuration&&(0,z.jsxs)("span",{children:[" (jusqu'au ",(0,F.A)(new Date(e.discountDuration),"dd/MM/yyyy"),")"]})]})}),(0,z.jsx)(be.Ay,{item:!0,xs:12,children:(0,z.jsxs)(m.A,{variant:"body2",children:[(0,z.jsx)("strong",{children:"Entreprise:"})," ",(null===(t=e.Company_id)||void 0===t?void 0:t.nom)||"N/A"]})}),(0,z.jsx)(be.Ay,{item:!0,xs:12,children:(0,z.jsx)(l.A,{sx:{display:"flex",flexWrap:"wrap",gap:.5,mt:1},children:null===(i=e.categoriesa_id)||void 0===i?void 0:i.map((e=>(0,z.jsx)(Oe.A,{label:(null===e||void 0===e?void 0:e.name)||"N/A",size:"small",color:"primary",variant:"outlined"},(null===e||void 0===e?void 0:e._id)||"temp")))})})]})]}),(0,z.jsxs)(l.A,{sx:{p:2,display:"flex",justifyContent:"space-between"},children:[(0,z.jsxs)(l.A,{children:[(0,z.jsx)(p.A,{title:"Modifier",children:(0,z.jsx)(h.A,{onClick:()=>ne(e),children:(0,z.jsx)(qe.A,{})})}),(0,z.jsx)(p.A,{title:"Supprimer",children:(0,z.jsx)(h.A,{onClick:()=>{return r=e._id,void O({open:!0,id:r});var r},children:(0,z.jsx)(q.A,{color:"error"})})})]}),(0,z.jsxs)(l.A,{children:[(0,z.jsx)(p.A,{title:"G\xe9rer les images",children:(0,z.jsx)(h.A,{onClick:()=>(e=>{ee(e),R(e.pictures||[]),v(!0)})(e),children:(0,z.jsx)(Xe.A,{color:"primary"})})}),(0,z.jsx)(p.A,{title:e.discountedPrice?"Modifier la remise":"Ajouter une remise",children:(0,z.jsx)(h.A,{onClick:()=>(e=>{var r;M(e._id),P({discountedPrice:(null===(r=e.discountedPrice)||void 0===r?void 0:r.toString())||"",discountDuration:e.discountDuration?(0,F.A)(new Date(e.discountDuration),"yyyy-MM-dd"):(0,F.A)(new Date(Date.now()+6048e5),"yyyy-MM-dd")}),g(!0)})(e),children:(0,z.jsx)(X.A,{color:e.discountedPrice?"error":"action"})})}),e.discountedPrice&&(0,z.jsx)(p.A,{title:"Supprimer la remise",children:(0,z.jsx)(h.A,{onClick:()=>{return r=e._id,void U({open:!0,id:r});var r},children:(0,z.jsx)(er.A,{color:"error"})})})]})]})]})},e._id)})):(0,z.jsx)(be.Ay,{item:!0,xs:12,children:(0,z.jsx)(me.A,{sx:{p:3,textAlign:"center"},children:(0,z.jsx)(m.A,{children:"Aucun produit trouv\xe9"})})})}),(0,z.jsx)(l.A,{sx:{display:"flex",justifyContent:"center",mt:3},children:(0,z.jsx)(Qe.A,{count:H,page:V,onChange:(e,r)=>{K(r)},color:"primary",showFirstButton:!0,showLastButton:!0})}),(0,z.jsxs)(Re.A,{open:x,onClose:ae,maxWidth:"md",fullWidth:!0,children:[(0,z.jsx)(Ne.A,{children:N?"Modifier le produit":"Ajouter un produit"}),(0,z.jsx)(Ie.A,{children:(0,z.jsxs)(be.Ay,{container:!0,spacing:2,sx:{mt:1},children:[(0,z.jsx)(be.Ay,{item:!0,xs:12,sm:6,children:(0,z.jsx)(je.A,{name:"nom",label:"Nom du produit",fullWidth:!0,value:b.nom,onChange:de,required:!0})}),(0,z.jsx)(be.Ay,{item:!0,xs:12,sm:6,children:(0,z.jsxs)(Te.A,{fullWidth:!0,children:[(0,z.jsx)(Ue.A,{id:"company-label",children:"Entreprise"}),(0,z.jsx)(Ve.A,{labelId:"company-label",name:"Company_id",value:b.Company_id,onChange:de,required:!0,children:o.map((e=>(0,z.jsx)(y.A,{value:e._id,children:e.nom},e._id)))})]})}),(0,z.jsx)(be.Ay,{item:!0,xs:12,sm:6,children:(0,z.jsx)(je.A,{name:"oldPrice",label:"Prix (\u20ac)",fullWidth:!0,type:"number",InputProps:{startAdornment:(0,z.jsx)(Ze.A,{position:"start",children:"\u20ac"})},value:b.oldPrice,onChange:de,required:!0})}),(0,z.jsx)(be.Ay,{item:!0,xs:12,sm:6,children:(0,z.jsx)(je.A,{name:"quantite",label:"Quantit\xe9 en stock",fullWidth:!0,type:"number",value:b.quantite,onChange:de})}),(0,z.jsx)(be.Ay,{item:!0,xs:12,children:(0,z.jsx)(je.A,{name:"description",label:"Description",fullWidth:!0,multiline:!0,rows:3,value:b.description,onChange:de})}),(0,z.jsx)(be.Ay,{item:!0,xs:12,children:(0,z.jsx)(je.A,{name:"features",label:"Caract\xe9ristiques",fullWidth:!0,multiline:!0,rows:2,value:b.features,onChange:de})}),(0,z.jsx)(be.Ay,{item:!0,xs:12,children:(0,z.jsxs)(Te.A,{fullWidth:!0,children:[(0,z.jsx)(Ue.A,{id:"categories-label",children:"Cat\xe9gories"}),(0,z.jsx)(Ve.A,{labelId:"categories-label",multiple:!0,name:"categoriesa_id",value:b.categoriesa_id,onChange:de,input:(0,z.jsx)(Ke.A,{label:"Cat\xe9gories"}),renderValue:e=>(0,z.jsx)(l.A,{sx:{display:"flex",flexWrap:"wrap",gap:.5},children:e.map((e=>{const r=s.find((r=>r._id===e));return r?(0,z.jsx)(Oe.A,{label:r.name},e):null}))}),children:s.map((e=>(0,z.jsx)(y.A,{value:e._id,children:e.name},e._id)))})]})}),(0,z.jsx)(be.Ay,{item:!0,xs:12,children:(0,z.jsxs)(Te.A,{fullWidth:!0,children:[(0,z.jsx)(Ue.A,{id:"subcategories-label",children:"Sous-cat\xe9gories"}),(0,z.jsx)(Ve.A,{labelId:"subcategories-label",multiple:!0,name:"subcategories_id",value:b.subcategories_id,onChange:de,input:(0,z.jsx)(Ke.A,{label:"Sous-cat\xe9gories"}),renderValue:e=>(0,z.jsx)(l.A,{sx:{display:"flex",flexWrap:"wrap",gap:.5},children:e.map((e=>{const r=n.find((r=>r._id===e));return r?(0,z.jsx)(Oe.A,{label:r.name},e):null}))}),disabled:0===b.categoriesa_id.length,children:J.map((e=>(0,z.jsx)(y.A,{value:e._id,children:e.name},e._id)))})]})}),(0,z.jsxs)(be.Ay,{item:!0,xs:12,children:[(0,z.jsx)("input",{accept:"image/*",style:{display:"none"},id:"images-upload",type:"file",multiple:!0,onChange:ue}),(0,z.jsx)("label",{htmlFor:"images-upload",children:(0,z.jsx)(S.A,{variant:"outlined",component:"span",children:N?"Ajouter des images":"Uploader des images"})}),(0,z.jsx)(l.A,{sx:{mt:2,display:"flex",flexWrap:"wrap"},children:k.map(((e,r)=>(0,z.jsx)(Be,{src:e,alt:`Preview ${r}`,onDelete:()=>(e=>{const r=[...E];r.splice(e,1),D(r);const s=[...k];s.splice(e,1),R(s)})(r)},r)))})]})]})}),(0,z.jsxs)(We.A,{children:[(0,z.jsx)(S.A,{onClick:ae,children:"Annuler"}),(0,z.jsx)(S.A,{onClick:async()=>{try{const e=new FormData;e.append("nom",b.nom),e.append("description",b.description),e.append("features",b.features),e.append("oldPrice",b.oldPrice),e.append("quantite",b.quantite),e.append("Company_id",b.Company_id),b.categoriesa_id.forEach((r=>{e.append("categoriesa_id",r)})),b.subcategories_id.forEach((r=>{e.append("subcategories_id",r)})),E.forEach((r=>{e.append("pictures",r)})),N?(await B.A.put(`/products/${W}`,e),L.oR.success("Produit mis \xe0 jour avec succ\xe8s")):(await B.A.post("/products",e),L.oR.success("Produit cr\xe9\xe9 avec succ\xe8s")),ae(),re()}catch(e){console.error("Erreur lors de l'enregistrement du produit:",e),L.oR.error("Erreur lors de l'enregistrement du produit")}},variant:"contained",disabled:!b.nom||!b.oldPrice||!b.Company_id||0===b.categoriesa_id.length,children:N?"Mettre \xe0 jour":"Ajouter"})]})]}),(0,z.jsxs)(Re.A,{open:A,onClose:oe,children:[(0,z.jsx)(Ne.A,{children:"G\xe9rer la remise"}),(0,z.jsx)(Ie.A,{children:(0,z.jsxs)(be.Ay,{container:!0,spacing:2,sx:{mt:1},children:[(0,z.jsx)(be.Ay,{item:!0,xs:12,children:(0,z.jsx)(je.A,{name:"discountedPrice",label:"Prix remis\xe9 (\u20ac)",fullWidth:!0,type:"number",InputProps:{startAdornment:(0,z.jsx)(Ze.A,{position:"start",children:"\u20ac"})},value:C.discountedPrice,onChange:ce,required:!0})}),(0,z.jsx)(be.Ay,{item:!0,xs:12,children:(0,z.jsx)(je.A,{name:"discountDuration",label:"Valable jusqu'au",type:"date",fullWidth:!0,value:C.discountDuration,onChange:ce,InputLabelProps:{shrink:!0}})})]})}),(0,z.jsxs)(We.A,{children:[(0,z.jsx)(S.A,{onClick:oe,children:"Annuler"}),(0,z.jsx)(S.A,{onClick:async()=>{try{await B.A.put(`/products/${W}/discount`,C),L.oR.success("Remise appliqu\xe9e avec succ\xe8s"),oe(),re()}catch(e){console.error("Erreur lors de l'application de la remise:",e),L.oR.error("Erreur lors de l'application de la remise")}},variant:"contained",disabled:!C.discountedPrice,children:"Appliquer la remise"})]})]}),(0,z.jsxs)(Re.A,{open:f,onClose:le,maxWidth:"md",children:[(0,z.jsx)(Ne.A,{children:"G\xe9rer les images du produit"}),(0,z.jsx)(Ie.A,{children:(0,z.jsxs)(be.Ay,{container:!0,spacing:2,children:[(0,z.jsxs)(be.Ay,{item:!0,xs:12,children:[(0,z.jsx)(m.A,{variant:"subtitle1",gutterBottom:!0,children:"Images actuelles"}),(0,z.jsx)(l.A,{sx:{display:"flex",flexWrap:"wrap",gap:1},children:Z&&Z.pictures&&Z.pictures.length>0?Z.pictures.map(((e,r)=>(0,z.jsxs)(l.A,{sx:{position:"relative",width:150,height:150,border:"1px solid #ddd",borderRadius:1,overflow:"hidden",mb:2},children:[(0,z.jsx)("img",{src:e,alt:`Image ${r}`,style:{width:"100%",height:"100%",objectFit:"cover"}}),(0,z.jsx)(h.A,{size:"small",sx:{position:"absolute",top:5,right:5,bgcolor:"rgba(255, 255, 255, 0.7)","&:hover":{bgcolor:"rgba(255, 255, 255, 0.9)"}},onClick:()=>(async(e,r)=>{try{await B.A.delete(`/products/${e}/image/${r}`),L.oR.success("Image supprim\xe9e avec succ\xe8s");const s=[...k];s.splice(r,1),R(s),re()}catch(s){console.error("Erreur lors de la suppression de l'image:",s),L.oR.error("Erreur lors de la suppression de l'image")}})(Z._id,r),children:(0,z.jsx)(q.A,{color:"error"})}),e===Z.mainPicture&&(0,z.jsx)(l.A,{sx:{position:"absolute",bottom:0,left:0,right:0,bgcolor:"primary.main",color:"white",textAlign:"center",py:.5},children:(0,z.jsx)(m.A,{variant:"caption",children:"Principale"})})]},r))):(0,z.jsx)(m.A,{variant:"body2",children:"Aucune image disponible"})})]}),(0,z.jsxs)(be.Ay,{item:!0,xs:12,children:[(0,z.jsx)(m.A,{variant:"subtitle1",gutterBottom:!0,children:"Ajouter de nouvelles images"}),(0,z.jsx)("input",{accept:"image/*",style:{display:"none"},id:"add-more-images",type:"file",multiple:!0,onChange:ue}),(0,z.jsx)("label",{htmlFor:"add-more-images",children:(0,z.jsx)(S.A,{variant:"contained",component:"span",children:"S\xe9lectionner des images"})}),(0,z.jsx)(l.A,{sx:{mt:2,display:"flex",flexWrap:"wrap",gap:1},children:E.map(((e,r)=>(0,z.jsx)(Be,{src:URL.createObjectURL(e),alt:`Nouvelle image ${r}`,onDelete:()=>{const e=[...E];e.splice(r,1),D(e)}},r)))})]})]})}),(0,z.jsxs)(We.A,{children:[(0,z.jsx)(S.A,{onClick:le,children:"Annuler"}),(0,z.jsx)(S.A,{onClick:async()=>{if(E.length>0&&Z){const r=new FormData;E.forEach((e=>{r.append("pictures",e)}));try{await B.A.put(`/products/${Z._id}`,r),L.oR.success("Images mises \xe0 jour avec succ\xe8s"),le(),re()}catch(e){console.error("Erreur lors de l'ajout d'images:",e),L.oR.error("Erreur lors de l'ajout d'images")}}else le()},variant:"contained",disabled:0===E.length,children:"Enregistrer les nouvelles images"})]})]}),(0,z.jsx)($e,{open:$.open,title:"Confirmer la suppression",message:"\xcates-vous s\xfbr de vouloir supprimer ce produit? Cette action est irr\xe9versible.",onConfirm:async()=>{try{await B.A.delete(`/products/${$.id}`),L.oR.success("Produit supprim\xe9 avec succ\xe8s"),re()}catch(e){console.error("Erreur lors de la suppression du produit:",e),L.oR.error("Erreur lors de la suppression du produit")}finally{O({open:!1,id:null})}},onCancel:()=>O({open:!1,id:null})}),(0,z.jsx)($e,{open:T.open,title:"Confirmer la suppression",message:"\xcates-vous s\xfbr de vouloir supprimer cette remise?",onConfirm:async()=>{try{await B.A.delete(`/products/${T.id}/discount`),L.oR.success("Remise supprim\xe9e avec succ\xe8s"),re()}catch(e){console.error("Erreur lors de la suppression de la remise:",e),L.oR.error("Erreur lors de la suppression de la remise")}finally{U({open:!1,id:null})}},onCancel:()=>U({open:!1,id:null})})]})};var sr=s(72236),tr=s(84142),ir=s(38517),nr=s(40196),ar=s(3937),or=s(49715),lr=s(8321),dr=s(29240),cr=s(23935),ur=s(31902),xr=s(68179),hr=s(37749),mr=s(81831),pr=s(82813),jr=s(59113),Ar=s(55271),gr=s(81095),yr=s(80294),fr=s(93245),vr=s(60158),br=s(44813),wr=s(16335),Cr=s(25102),Pr=s(85706),Sr=s(67360),_r=s(54203),Er=s(72528),Dr=s(2847),kr=s(56473),Rr=s(58535),Nr=s(43754),Ir=s(37885);const Wr=e=>{var r;let{order:s}=e;if(!s)return null;const t=["en attente","confirm\xe9e","en pr\xe9paration","exp\xe9di\xe9e","livr\xe9e","pay\xe9e"],i=e=>{try{return new Date(e).toLocaleString("fr-FR",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"})}catch(r){return"Date invalide"}};return(0,z.jsxs)(l.A,{children:[(0,z.jsxs)(be.Ay,{container:!0,spacing:3,children:[(0,z.jsxs)(be.Ay,{item:!0,xs:12,md:6,children:[(0,z.jsxs)(m.A,{variant:"h6",gutterBottom:!0,children:["Commande #",s.orderNumber]}),(0,z.jsxs)(m.A,{variant:"body2",color:"text.secondary",children:["Cr\xe9\xe9e le ",i(s.createdAt)]})]}),(0,z.jsxs)(be.Ay,{item:!0,xs:12,md:6,sx:{textAlign:"right"},children:[(0,z.jsx)(Oe.A,{label:s.status,color:"annul\xe9e"===s.status?"error":"livr\xe9e"===s.status||"pay\xe9e"===s.status?"success":"exp\xe9di\xe9e"===s.status?"primary":"en pr\xe9paration"===s.status?"secondary":"warning",sx:{mb:1}}),(0,z.jsxs)(m.A,{variant:"body2",children:["Paiement: ",s.isPaid?"Pay\xe9":"En attente de paiement",s.paymentDate&&` (${i(s.paymentDate)})`]})]})]}),"annul\xe9e"!==s.status?(0,z.jsx)(l.A,{sx:{mb:4,mt:3},children:(0,z.jsx)(Rr.A,{activeStep:"annul\xe9e"===s.status?-1:t.indexOf(s.status),alternativeLabel:!0,children:t.map((e=>(0,z.jsx)(Nr.A,{children:(0,z.jsx)(Ir.A,{children:e.charAt(0).toUpperCase()+e.slice(1)})},e)))})}):(0,z.jsx)(l.A,{sx:{mb:4,mt:3,bgcolor:"#ffebee",p:2,borderRadius:1},children:(0,z.jsx)(m.A,{color:"error",align:"center",children:"Cette commande a \xe9t\xe9 annul\xe9e"})}),(0,z.jsx)(g.A,{sx:{my:3}}),(0,z.jsxs)(be.Ay,{container:!0,spacing:4,children:[(0,z.jsxs)(be.Ay,{item:!0,xs:12,md:6,children:[(0,z.jsx)(m.A,{variant:"h6",gutterBottom:!0,children:"Informations client"}),(0,z.jsxs)(me.A,{variant:"outlined",sx:{p:2},children:[(0,z.jsxs)(m.A,{children:[s.customer.firstName," ",s.customer.lastName]}),(0,z.jsxs)(m.A,{variant:"body2",children:["T\xe9l\xe9phone: ",s.customer.phone]})]})]}),(0,z.jsxs)(be.Ay,{item:!0,xs:12,md:6,children:[(0,z.jsx)(m.A,{variant:"h6",gutterBottom:!0,children:"Adresse de livraison"}),(0,z.jsxs)(me.A,{variant:"outlined",sx:{p:2},children:[(0,z.jsx)(m.A,{variant:"body1",children:s.shippingAddress.address}),(0,z.jsxs)(m.A,{variant:"body1",children:[s.shippingAddress.postalCode," ",s.shippingAddress.city]}),(0,z.jsx)(m.A,{variant:"body1",children:s.shippingAddress.country}),s.shippingAddress.additionalInfo&&(0,z.jsxs)(m.A,{variant:"body2",color:"text.secondary",sx:{mt:1},children:["Informations compl\xe9mentaires: ",s.shippingAddress.additionalInfo]})]})]})]}),(0,z.jsx)(g.A,{sx:{my:3}}),(0,z.jsx)(m.A,{variant:"h6",gutterBottom:!0,children:"Produits command\xe9s"}),(0,z.jsx)(Pe.A,{component:me.A,variant:"outlined",children:(0,z.jsxs)(Se.A,{children:[(0,z.jsx)(_e.A,{children:(0,z.jsxs)(Ee.A,{children:[(0,z.jsx)(De.A,{children:"Produit"}),(0,z.jsx)(De.A,{align:"center",children:"Prix unitaire"}),(0,z.jsx)(De.A,{align:"center",children:"Quantit\xe9"}),(0,z.jsx)(De.A,{align:"right",children:"Total"})]})}),(0,z.jsxs)(ke.A,{children:[s.items.map(((e,r)=>(0,z.jsxs)(Ee.A,{children:[(0,z.jsx)(De.A,{children:(0,z.jsxs)(l.A,{sx:{display:"flex",alignItems:"center"},children:[e.product&&e.product.mainPicture&&(0,z.jsx)(j.A,{src:e.product.mainPicture,alt:e.productName,variant:"rounded",sx:{width:40,height:40,mr:2}}),(0,z.jsxs)(l.A,{children:[(0,z.jsx)(m.A,{variant:"body2",children:e.productName}),e.product&&e.product.Company_id&&(0,z.jsx)(m.A,{variant:"caption",color:"text.secondary",children:"object"===typeof e.product.Company_id?e.product.Company_id.nom:"Marque"})]})]})}),(0,z.jsxs)(De.A,{align:"center",children:[e.price.toFixed(2)," \u20ac"]}),(0,z.jsx)(De.A,{align:"center",children:e.quantity}),(0,z.jsxs)(De.A,{align:"right",children:[e.totalPrice.toFixed(2)," \u20ac"]})]},r))),(0,z.jsxs)(Ee.A,{children:[(0,z.jsx)(De.A,{colSpan:3,align:"right",sx:{fontWeight:"bold"},children:"Total"}),(0,z.jsxs)(De.A,{align:"right",sx:{fontWeight:"bold"},children:[s.totalAmount.toFixed(2)," \u20ac"]})]})]})]})}),(0,z.jsx)(g.A,{sx:{my:3}}),(0,z.jsx)(m.A,{variant:"h6",gutterBottom:!0,children:"Historique"}),(0,z.jsx)(me.A,{variant:"outlined",sx:{p:0},children:(0,z.jsx)(E.A,{sx:{width:"100%"},children:null===(r=s.statusHistory)||void 0===r?void 0:r.map(((e,r)=>(0,z.jsx)(D.Ay,{divider:r<s.statusHistory.length-1,children:(0,z.jsx)(v.A,{primary:(0,z.jsxs)(l.A,{sx:{display:"flex",justifyContent:"space-between"},children:[(0,z.jsxs)(m.A,{variant:"body2",sx:{fontWeight:"medium"},children:["Statut: ",(0,z.jsx)(Oe.A,{size:"small",label:e.status,sx:{ml:1}})]}),(0,z.jsx)(m.A,{variant:"body2",color:"text.secondary",children:i(e.date)})]}),secondary:e.comment&&`Commentaire: ${e.comment}`})},r)))})}),s.notes&&(0,z.jsxs)(l.A,{sx:{mt:3},children:[(0,z.jsx)(m.A,{variant:"h6",gutterBottom:!0,children:"Notes"}),(0,z.jsx)(me.A,{variant:"outlined",sx:{p:2},children:(0,z.jsx)(m.A,{variant:"body2",children:s.notes})})]})]})},Mr=e=>{let{open:r,onClose:s,onUpdateStatus:i,order:n,statuses:a}=e;const[o,d]=(0,t.useState)(""),[c,u]=(0,t.useState)(""),[x,h]=(0,t.useState)("");t.useEffect((()=>{r&&n&&(d(n.status),u(""),h(""))}),[r,n]);return n?(0,z.jsxs)(Re.A,{open:r,onClose:s,fullWidth:!0,maxWidth:"sm",children:[(0,z.jsx)(Ne.A,{children:"Mettre \xe0 jour le statut de la commande"}),(0,z.jsxs)(Ie.A,{dividers:!0,children:[(0,z.jsxs)(m.A,{variant:"subtitle1",gutterBottom:!0,children:["Commande #",n.orderNumber]}),(0,z.jsxs)(m.A,{variant:"body2",color:"text.secondary",gutterBottom:!0,children:["Client: ",n.customer.firstName," ",n.customer.lastName]}),(0,z.jsx)(g.A,{sx:{my:2}}),x&&(0,z.jsx)(pe.A,{severity:"error",sx:{mb:2},children:x}),(0,z.jsxs)(Te.A,{fullWidth:!0,sx:{mb:3},children:[(0,z.jsx)(Ue.A,{children:"Statut"}),(0,z.jsx)(Ve.A,{value:o,onChange:e=>d(e.target.value),label:"Statut",children:a.map((e=>(0,z.jsx)(y.A,{value:e.value,children:e.label},e.value)))})]}),(0,z.jsx)(je.A,{fullWidth:!0,label:"Commentaire (optionnel)",multiline:!0,rows:3,value:c,onChange:e=>u(e.target.value),placeholder:"Ajoutez un commentaire sur la mise \xe0 jour du statut..."}),(0,z.jsx)(l.A,{sx:{mt:3,p:2,bgcolor:"#f5f5f5",borderRadius:1},children:(0,z.jsxs)(m.A,{variant:"body2",children:[(0,z.jsx)("strong",{children:"Note:"}),' Si vous d\xe9finissez le statut sur "pay\xe9e", la commande sera automatiquement marqu\xe9e comme pay\xe9e avec la date actuelle.']})})]}),(0,z.jsxs)(We.A,{children:[(0,z.jsx)(S.A,{onClick:s,children:"Annuler"}),(0,z.jsx)(S.A,{variant:"contained",color:"primary",onClick:()=>{o?i(o,c):h("Veuillez s\xe9lectionner un statut")},children:"Mettre \xe0 jour"})]})]}):null},qr=["#0088FE","#00C49F","#FFBB28","#FF8042","#A52A2A","#7B68EE","#FF6347","#20B2AA"],Fr=()=>{const e=(0,a.A)(),[r,s]=(0,t.useState)(0),[i,n]=(0,t.useState)([]),[o,d]=(0,t.useState)([]),[c,u]=(0,t.useState)(!0),[x,j]=(0,t.useState)(""),[A,g]=(0,t.useState)(""),[f,v]=(0,t.useState)(""),[b,w]=(0,t.useState)({startDate:null,endDate:null}),[C,P]=(0,t.useState)(!1),[E,D]=(0,t.useState)("3months"),[k,R]=(0,t.useState)(0),[N,I]=(0,t.useState)(null),[W,M]=(0,t.useState)(!1),[q,O]=(0,t.useState)(!1),[T,U]=(0,t.useState)(null),[K,G]=(0,t.useState)({totalOrders:0,totalRevenue:0,ordersByStatus:[],ordersByDay:[]}),H=[{value:"en attente",label:"En attente",color:"warning"},{value:"confirm\xe9e",label:"Confirm\xe9e",color:"info"},{value:"en pr\xe9paration",label:"En pr\xe9paration",color:"secondary"},{value:"exp\xe9di\xe9e",label:"Exp\xe9di\xe9e",color:"primary"},{value:"livr\xe9e",label:"Livr\xe9e",color:"success"},{value:"pay\xe9e",label:"Pay\xe9e",color:"success"},{value:"annul\xe9e",label:"Annul\xe9e",color:"error"}],Y=async()=>{try{const e=b.startDate&&b.endDate?i.filter((e=>{const r=new Date(e.createdAt);return r>=b.startDate&&r<=b.endDate})):i,r={totalOrders:e.length,totalRevenue:e.reduce(((e,r)=>e+r.totalAmount),0),ordersByStatus:Object.entries(e.reduce(((e,r)=>(e[r.status]=(e[r.status]||0)+1,e)),{})).map((r=>{let[s,t]=r;return{_id:s,count:t,total:e.filter((e=>e.status===s)).reduce(((e,r)=>e+r.totalAmount),0)}})),ordersByDay:Object.entries(e.reduce(((e,r)=>{const s=new Date(r.createdAt).toLocaleDateString("fr-FR");return e[s]=(e[s]||0)+1,e}),{})).map((e=>{let[r,s]=e;return{name:r,count:s}}))};G(r)}catch(x){console.error("Erreur lors du calcul des statistiques:",x)}},J=()=>{const e=i.reduce(((e,r)=>(e[r.status]=(e[r.status]||0)+1,e)),{});return Object.entries(e).map((e=>{let[r,s]=e;return{name:r,count:s}})).sort(((e,r)=>r.count-e.count))},Q=()=>[{name:"< 50\u20ac",value:i.filter((e=>e.totalAmount<50)).length},{name:"50-100\u20ac",value:i.filter((e=>e.totalAmount>=50&&e.totalAmount<100)).length},{name:"100-200\u20ac",value:i.filter((e=>e.totalAmount>=100&&e.totalAmount<200)).length},{name:"200-500\u20ac",value:i.filter((e=>e.totalAmount>=200&&e.totalAmount<500)).length},{name:"> 500\u20ac",value:i.filter((e=>e.totalAmount>=500)).length}],Z=()=>{const e=new Date;let r,s=[];switch(E){case"3months":default:r=3;break;case"6months":r=6;break;case"12months":r=12}for(let t=0;t<r;t++){const r=(0,jr.A)(e,t),n=(0,F.A)(r,"MMMM yyyy",{locale:$.A}),a=i.filter((e=>{const s=new Date(e.createdAt);return s.getMonth()===r.getMonth()&&s.getFullYear()===r.getFullYear()})),o={name:n,totalOrders:a.length,totalRevenue:a.reduce(((e,r)=>e+r.totalAmount),0),averageOrderValue:a.length>0?a.reduce(((e,r)=>e+r.totalAmount),0)/a.length:0};s.push(o)}return s.reverse()},X=()=>{const e=Ar.Wp.book_new(),r=i.map((e=>({"N\xb0 de commande":e.orderNumber,Date:(0,F.A)(new Date(e.createdAt),"dd/MM/yyyy"),Client:`${e.customer.firstName} ${e.customer.lastName}`,Email:e.customer.email,"T\xe9l\xe9phone":e.customer.phone,"Montant total":e.totalAmount,Statut:e.status,"Pay\xe9e":e.isPaid?"Oui":"Non","M\xe9thode de paiement":e.paymentMethod||"N/A","Adresse de livraison":`${e.shippingAddress.street}, ${e.shippingAddress.city}, ${e.shippingAddress.postalCode}`}))),s=Ar.Wp.json_to_sheet(r);Ar.Wp.book_append_sheet(e,s,"Commandes");const t=J().map((e=>({Statut:e.name,"Nombre de commandes":e.count}))),n=Ar.Wp.json_to_sheet(t);Ar.Wp.book_append_sheet(e,n,"Statuts des commandes");const a=Z().map((e=>({Mois:e.name,"Nombre de commandes":e.totalOrders,"Chiffre d'affaires":e.totalRevenue.toFixed(2),"Valeur moyenne des commandes":e.averageOrderValue.toFixed(2)}))),o=Ar.Wp.json_to_sheet(a);Ar.Wp.book_append_sheet(e,o,"Statistiques mensuelles"),Ar._h(e,`Rapport_Commandes_${(0,F.A)(new Date,"yyyy-MM-dd")}.xlsx`),L.oR.success("Donn\xe9es export\xe9es avec succ\xe8s")};(0,t.useEffect)((()=>{if(!A.trim())return void d(i);const e=A.toLowerCase(),r=i.filter((r=>r.orderNumber.toLowerCase().includes(e)||`${r.customer.firstName} ${r.customer.lastName}`.toLowerCase().includes(e)||r.customer.email.toLowerCase().includes(e)||r.customer.phone.includes(A)));d(r)}),[A,i]),(0,t.useEffect)((()=>{i.length>0&&Y()}),[i,b.startDate,b.endDate]);const ee=()=>{g(""),v(""),w({startDate:null,endDate:null})},re=e=>{const r=H.find((r=>r.value===e));return r?r.color:"default"};return(0,z.jsxs)(l.A,{sx:{p:3},children:[(0,z.jsx)(m.A,{variant:"h4",sx:{mb:3},children:"Gestion des commandes"}),(0,z.jsxs)(sr.A,{value:r,onChange:(e,r)=>{s(r)},sx:{mb:3},variant:"scrollable",children:[(0,z.jsx)(tr.A,{label:"Liste des commandes"}),(0,z.jsx)(tr.A,{label:"Statistiques"})]}),0===r&&(0,z.jsxs)(l.A,{children:[(0,z.jsxs)(me.A,{sx:{p:2,mb:3},children:[(0,z.jsxs)(be.Ay,{container:!0,spacing:2,alignItems:"center",children:[(0,z.jsx)(be.Ay,{item:!0,xs:12,md:4,children:(0,z.jsx)(je.A,{fullWidth:!0,placeholder:"Rechercher une commande...",value:A,onChange:e=>g(e.target.value),InputProps:{startAdornment:(0,z.jsx)(or.A,{sx:{mr:1,color:"text.secondary"}})}})}),(0,z.jsx)(be.Ay,{item:!0,xs:12,md:8,children:(0,z.jsxs)(l.A,{sx:{display:"flex",gap:2},children:[(0,z.jsx)(S.A,{variant:C?"contained":"outlined",startIcon:(0,z.jsx)(lr.A,{}),onClick:()=>P(!C),children:"Filtres"}),(0,z.jsx)(S.A,{variant:"outlined",startIcon:(0,z.jsx)(dr.A,{}),onClick:()=>{(async()=>{try{u(!0);let e={};f&&(e.status=f),b.startDate&&b.endDate&&(e.startDate=b.startDate.toISOString(),e.endDate=b.endDate.toISOString());const r=await B.A.get("/orders",{params:e});r.data.success&&(n(r.data.data),d(r.data.data)),u(!1)}catch(x){console.error("Erreur lors du chargement des commandes:",x),j("Impossible de charger les commandes. Veuillez r\xe9essayer plus tard."),u(!1)}})(),Y()},children:"Actualiser"}),(0,z.jsx)(S.A,{variant:"outlined",startIcon:(0,z.jsx)(cr.A,{}),onClick:X,children:"Exporter (Excel)"})]})})]}),(0,z.jsx)(V.A,{in:C,children:(0,z.jsx)(l.A,{sx:{mt:3},children:(0,z.jsxs)(be.Ay,{container:!0,spacing:2,alignItems:"center",children:[(0,z.jsx)(be.Ay,{item:!0,xs:12,md:3,children:(0,z.jsxs)(Te.A,{fullWidth:!0,children:[(0,z.jsx)(Ue.A,{children:"Statut"}),(0,z.jsxs)(Ve.A,{value:f,onChange:e=>v(e.target.value),label:"Statut",children:[(0,z.jsx)(y.A,{value:"",children:"Tous"}),H.map((e=>(0,z.jsx)(y.A,{value:e.value,children:e.label},e.value)))]})]})}),(0,z.jsx)(be.Ay,{item:!0,xs:12,md:3,children:(0,z.jsx)(mr.$,{dateAdapter:hr.h,locale:$.A,children:(0,z.jsx)(pr.l,{label:"Date de d\xe9but",value:b.startDate,onChange:e=>w({...b,startDate:e}),renderInput:e=>(0,z.jsx)(je.A,{...e,fullWidth:!0})})})}),(0,z.jsx)(be.Ay,{item:!0,xs:12,md:3,children:(0,z.jsx)(mr.$,{dateAdapter:hr.h,locale:$.A,children:(0,z.jsx)(pr.l,{label:"Date de fin",value:b.endDate,onChange:e=>w({...b,endDate:e}),renderInput:e=>(0,z.jsx)(je.A,{...e,fullWidth:!0})})})}),(0,z.jsx)(be.Ay,{item:!0,xs:12,md:3,children:(0,z.jsx)(S.A,{variant:"outlined",color:"error",startIcon:(0,z.jsx)(ur.A,{}),onClick:ee,fullWidth:!0,children:"Effacer les filtres"})})]})})})]}),c?(0,z.jsx)(l.A,{sx:{display:"flex",justifyContent:"center",p:3},children:(0,z.jsx)(_.A,{})}):x?(0,z.jsx)(pe.A,{severity:"error",sx:{mb:3},children:x}):0===o.length?(0,z.jsx)(pe.A,{severity:"info",children:"Aucune commande ne correspond \xe0 vos crit\xe8res de recherche."}):(0,z.jsx)(Pe.A,{component:me.A,children:(0,z.jsxs)(Se.A,{children:[(0,z.jsx)(_e.A,{children:(0,z.jsxs)(Ee.A,{children:[(0,z.jsx)(De.A,{children:"N\xb0 de commande"}),(0,z.jsx)(De.A,{children:"Date"}),(0,z.jsx)(De.A,{children:"Client"}),(0,z.jsx)(De.A,{children:"Montant"}),(0,z.jsx)(De.A,{children:"Statut"}),(0,z.jsx)(De.A,{children:"Paiement"}),(0,z.jsx)(De.A,{align:"center",children:"Actions"})]})}),(0,z.jsx)(ke.A,{children:o.map((e=>(0,z.jsxs)(Ee.A,{hover:!0,children:[(0,z.jsx)(De.A,{children:e.orderNumber}),(0,z.jsx)(De.A,{children:new Date(e.createdAt).toLocaleDateString("fr-FR")}),(0,z.jsxs)(De.A,{children:[(0,z.jsxs)(m.A,{variant:"body2",children:[e.customer.firstName," ",e.customer.lastName]}),(0,z.jsx)(m.A,{variant:"caption",color:"text.secondary",children:e.customer.email})]}),(0,z.jsxs)(De.A,{children:[e.totalAmount.toFixed(2)," \u20ac"]}),(0,z.jsx)(De.A,{children:(0,z.jsx)(Oe.A,{label:e.status,color:re(e.status),size:"small"})}),(0,z.jsx)(De.A,{children:(0,z.jsx)(Oe.A,{label:e.isPaid?"Pay\xe9e":"En attente",color:e.isPaid?"success":"default",size:"small",variant:e.isPaid?"filled":"outlined"})}),(0,z.jsxs)(De.A,{align:"center",children:[(0,z.jsx)(p.A,{title:"Voir les d\xe9tails",children:(0,z.jsx)(h.A,{color:"primary",onClick:()=>(e=>{I(e),M(!0)})(e),children:(0,z.jsx)(xr.A,{})})}),(0,z.jsx)(p.A,{title:"Modifier le statut",children:(0,z.jsx)(h.A,{color:"secondary",onClick:()=>(e=>{U(e),O(!0)})(e),children:(0,z.jsx)(qe.A,{})})})]})]},e._id)))})]})})]}),1===r&&(()=>{var r,s;return(0,z.jsxs)(z.Fragment,{children:[(0,z.jsxs)(sr.A,{value:k,onChange:(e,r)=>R(r),indicatorColor:"primary",textColor:"primary",centered:!0,sx:{mb:3},children:[(0,z.jsx)(tr.A,{icon:(0,z.jsx)(ir.A,{}),label:"Vue d'ensemble"}),(0,z.jsx)(tr.A,{icon:(0,z.jsx)(nr.A,{}),label:"Tendances"}),(0,z.jsx)(tr.A,{icon:(0,z.jsx)(ar.A,{}),label:"R\xe9partition"})]}),0===k&&(0,z.jsxs)(be.Ay,{container:!0,spacing:3,children:[(0,z.jsx)(be.Ay,{item:!0,xs:12,md:4,children:(0,z.jsx)(He.A,{sx:{height:"100%",bgcolor:e.palette.primary.light,color:"white"},children:(0,z.jsxs)(Je.A,{children:[(0,z.jsx)(m.A,{variant:"h6",gutterBottom:!0,children:"Total des commandes"}),(0,z.jsx)(m.A,{variant:"h3",children:K.totalOrders})]})})}),(0,z.jsx)(be.Ay,{item:!0,xs:12,md:4,children:(0,z.jsx)(He.A,{sx:{height:"100%",bgcolor:e.palette.success.light,color:"white"},children:(0,z.jsxs)(Je.A,{children:[(0,z.jsx)(m.A,{variant:"h6",gutterBottom:!0,children:"Chiffre d'affaires"}),(0,z.jsxs)(m.A,{variant:"h3",children:[K.totalRevenue.toFixed(2)," \u20ac"]})]})})}),(0,z.jsx)(be.Ay,{item:!0,xs:12,md:4,children:(0,z.jsx)(He.A,{sx:{height:"100%",bgcolor:e.palette.warning.light,color:"white"},children:(0,z.jsxs)(Je.A,{children:[(0,z.jsx)(m.A,{variant:"h6",gutterBottom:!0,children:"Commandes en attente"}),(0,z.jsx)(m.A,{variant:"h3",children:(null===(r=K.ordersByStatus)||void 0===r||null===(s=r.find((e=>"en attente"===e._id)))||void 0===s?void 0:s.count)||0})]})})}),(0,z.jsx)(be.Ay,{item:!0,xs:12,children:(0,z.jsxs)(me.A,{sx:{p:3},children:[(0,z.jsx)(m.A,{variant:"h6",gutterBottom:!0,children:"Commandes par statut"}),(0,z.jsx)(gr.u,{width:"100%",height:300,children:(0,z.jsxs)(yr.E,{data:J(),margin:{top:20,right:30,left:20,bottom:5},children:[(0,z.jsx)(fr.d,{strokeDasharray:"3 3"}),(0,z.jsx)(vr.W,{dataKey:"name"}),(0,z.jsx)(br.h,{}),(0,z.jsx)(wr.m,{}),(0,z.jsx)(Cr.s,{}),(0,z.jsx)(Pr.y,{dataKey:"count",name:"Nombre de commandes",fill:"#8884d8"})]})})]})}),(0,z.jsx)(be.Ay,{item:!0,xs:12,md:6,children:(0,z.jsxs)(me.A,{sx:{p:3},children:[(0,z.jsx)(m.A,{variant:"h6",gutterBottom:!0,children:"R\xe9partition des commandes par tranche de prix"}),(0,z.jsx)(gr.u,{width:"100%",height:300,children:(0,z.jsxs)(Sr.r,{children:[(0,z.jsx)(_r.F,{data:Q(),cx:"50%",cy:"50%",labelLine:!1,outerRadius:100,fill:"#8884d8",dataKey:"value",label:e=>{let{name:r,percent:s}=e;return`${r} ${(100*s).toFixed(0)}%`},children:Q().map(((e,r)=>(0,z.jsx)(Er.f,{fill:qr[r%qr.length]},`cell-${r}`)))}),(0,z.jsx)(wr.m,{})]})})]})}),(0,z.jsx)(be.Ay,{item:!0,xs:12,md:6,children:(0,z.jsxs)(me.A,{sx:{p:3},children:[(0,z.jsx)(m.A,{variant:"h6",gutterBottom:!0,children:"Top 10 Clients"}),(0,z.jsx)(Pe.A,{children:(0,z.jsxs)(Se.A,{children:[(0,z.jsx)(_e.A,{children:(0,z.jsxs)(Ee.A,{children:[(0,z.jsx)(De.A,{children:"Client"}),(0,z.jsx)(De.A,{align:"right",children:"Nombre de commandes"}),(0,z.jsx)(De.A,{align:"right",children:"Montant total"})]})}),(0,z.jsx)(ke.A,{children:Object.entries(i.reduce(((e,r)=>{const s=`${r.customer.firstName} ${r.customer.lastName}`;return e[s]=e[s]||{count:0,total:0,email:r.customer.email},e[s].count++,e[s].total+=r.totalAmount,e}),{})).sort(((e,r)=>r[1].count-e[1].count)).slice(0,10).map((e=>{let[r,s]=e;return(0,z.jsxs)(Ee.A,{children:[(0,z.jsxs)(De.A,{children:[r,(0,z.jsx)(m.A,{variant:"caption",color:"text.secondary",display:"block",children:s.email})]}),(0,z.jsx)(De.A,{align:"right",children:s.count}),(0,z.jsxs)(De.A,{align:"right",children:[s.total.toFixed(2)," \u20ac"]})]},r)}))})]})})]})})]}),1===k&&(0,z.jsxs)(z.Fragment,{children:[(0,z.jsx)(l.A,{sx:{mb:3,display:"flex",justifyContent:"flex-end"},children:(0,z.jsxs)(Te.A,{sx:{minWidth:150},children:[(0,z.jsx)(Ue.A,{id:"period-label",children:"P\xe9riode"}),(0,z.jsxs)(Ve.A,{labelId:"period-label",value:E,onChange:e=>D(e.target.value),label:"P\xe9riode",children:[(0,z.jsx)(y.A,{value:"3months",children:"3 derniers mois"}),(0,z.jsx)(y.A,{value:"6months",children:"6 derniers mois"}),(0,z.jsx)(y.A,{value:"12months",children:"12 derniers mois"})]})]})}),(0,z.jsx)(be.Ay,{container:!0,spacing:3,children:(0,z.jsx)(be.Ay,{item:!0,xs:12,children:(0,z.jsxs)(me.A,{sx:{p:3},children:[(0,z.jsx)(m.A,{variant:"h6",gutterBottom:!0,children:"\xc9volution mensuelle des commandes"}),(0,z.jsx)(gr.u,{width:"100%",height:400,children:(0,z.jsxs)(Dr.b,{data:Z(),margin:{top:20,right:30,left:20,bottom:5},children:[(0,z.jsx)(fr.d,{strokeDasharray:"3 3"}),(0,z.jsx)(vr.W,{dataKey:"name"}),(0,z.jsx)(br.h,{yAxisId:"left"}),(0,z.jsx)(br.h,{yAxisId:"right",orientation:"right"}),(0,z.jsx)(wr.m,{}),(0,z.jsx)(Cr.s,{}),(0,z.jsx)(kr.N,{yAxisId:"left",type:"monotone",dataKey:"totalOrders",name:"Nombre de commandes",stroke:"#8884d8",activeDot:{r:8}}),(0,z.jsx)(kr.N,{yAxisId:"right",type:"monotone",dataKey:"totalRevenue",name:"Chiffre d'affaires",stroke:"#82ca9d"}),(0,z.jsx)(kr.N,{yAxisId:"left",type:"monotone",dataKey:"averageOrderValue",name:"Valeur moyenne",stroke:"#ff7300"})]})})]})})})]}),2===k&&(0,z.jsxs)(be.Ay,{container:!0,spacing:3,children:[(0,z.jsx)(be.Ay,{item:!0,xs:12,md:6,children:(0,z.jsxs)(me.A,{sx:{p:3},children:[(0,z.jsx)(m.A,{variant:"h6",gutterBottom:!0,children:"R\xe9partition des commandes par statut"}),(0,z.jsx)(gr.u,{width:"100%",height:400,children:(0,z.jsxs)(Sr.r,{children:[(0,z.jsx)(_r.F,{data:J(),cx:"50%",cy:"50%",labelLine:!1,outerRadius:150,fill:"#8884d8",dataKey:"count",label:e=>{let{name:r,percent:s}=e;return s>.05?`${r} ${(100*s).toFixed(0)}%`:""},children:J().map(((e,r)=>(0,z.jsx)(Er.f,{fill:qr[r%qr.length]},`cell-${r}`)))}),(0,z.jsx)(wr.m,{})]})})]})}),(0,z.jsx)(be.Ay,{item:!0,xs:12,md:6,children:(0,z.jsxs)(me.A,{sx:{p:3},children:[(0,z.jsx)(m.A,{variant:"h6",gutterBottom:!0,children:"R\xe9partition des m\xe9thodes de paiement"}),(0,z.jsx)(gr.u,{width:"100%",height:400,children:(0,z.jsxs)(Sr.r,{children:[(0,z.jsx)(_r.F,{data:Object.entries(i.reduce(((e,r)=>{const s=r.paymentMethod||"Non sp\xe9cifi\xe9";return e[s]=(e[s]||0)+1,e}),{})).map((e=>{let[r,s]=e;return{name:r,value:s}})),cx:"50%",cy:"50%",labelLine:!1,outerRadius:150,fill:"#8884d8",dataKey:"value",label:e=>{let{name:r,percent:s}=e;return s>.05?`${r} ${(100*s).toFixed(0)}%`:""},children:Object.entries(i.reduce(((e,r)=>{const s=r.paymentMethod||"Non sp\xe9cifi\xe9";return e[s]=(e[s]||0)+1,e}),{})).map(((e,r)=>{let[s,t]=e;return(0,z.jsx)(Er.f,{fill:qr[r%qr.length]},`cell-${r}`)}))}),(0,z.jsx)(wr.m,{})]})})]})}),(0,z.jsx)(be.Ay,{item:!0,xs:12,children:(0,z.jsxs)(me.A,{sx:{p:3},children:[(0,z.jsx)(m.A,{variant:"h6",gutterBottom:!0,children:"D\xe9lais de traitement des commandes"}),(0,z.jsx)(gr.u,{width:"100%",height:300,children:(0,z.jsxs)(yr.E,{data:[{name:"< 1 jour",value:i.filter((e=>new Date(e.updatedAt)-new Date(e.createdAt)<864e5)).length},{name:"1-3 jours",value:i.filter((e=>{const r=new Date(e.updatedAt)-new Date(e.createdAt);return r>=864e5&&r<2592e5})).length},{name:"3-7 jours",value:i.filter((e=>{const r=new Date(e.updatedAt)-new Date(e.createdAt);return r>=2592e5&&r<6048e5})).length},{name:"> 7 jours",value:i.filter((e=>new Date(e.updatedAt)-new Date(e.createdAt)>=6048e5)).length}],margin:{top:20,right:30,left:20,bottom:5},children:[(0,z.jsx)(fr.d,{strokeDasharray:"3 3"}),(0,z.jsx)(vr.W,{dataKey:"name"}),(0,z.jsx)(br.h,{}),(0,z.jsx)(wr.m,{}),(0,z.jsx)(Cr.s,{}),(0,z.jsx)(Pr.y,{dataKey:"value",name:"Nombre de commandes",fill:"#8884d8",children:[{name:"< 1 jour",value:i.filter((e=>new Date(e.updatedAt)-new Date(e.createdAt)<864e5)).length},{name:"1-3 jours",value:i.filter((e=>{const r=new Date(e.updatedAt)-new Date(e.createdAt);return r>=864e5&&r<2592e5})).length},{name:"3-7 jours",value:i.filter((e=>{const r=new Date(e.updatedAt)-new Date(e.createdAt);return r>=2592e5&&r<6048e5})).length},{name:"> 7 jours",value:i.filter((e=>new Date(e.updatedAt)-new Date(e.createdAt)>=6048e5)).length}].map(((e,r)=>(0,z.jsx)(Er.f,{fill:qr[r%qr.length]},`cell-${r}`)))})]})})]})})]})]})})(),(0,z.jsxs)(Re.A,{open:W,onClose:()=>M(!1),fullWidth:!0,maxWidth:"md",children:[(0,z.jsxs)(Ne.A,{children:["D\xe9tails de la commande ",null===N||void 0===N?void 0:N.orderNumber]}),(0,z.jsx)(Ie.A,{dividers:!0,children:N&&(0,z.jsx)(Wr,{order:N})}),(0,z.jsx)(We.A,{children:(0,z.jsx)(S.A,{onClick:()=>M(!1),children:"Fermer"})})]}),(0,z.jsx)(Mr,{open:q,onClose:()=>{O(!1),U(null)},onUpdateStatus:async(e,r)=>{try{if(!T)return;const s=await B.A.patch(`/orders/${T._id}/status`,{status:e,comment:r});s.data.success&&(n((e=>e.map((e=>e._id===T._id?s.data.data:e)))),O(!1),U(null),Y())}catch(x){console.error("Erreur lors de la mise \xe0 jour du statut:",x),j("Impossible de mettre \xe0 jour le statut. Veuillez r\xe9essayer plus tard.")}},order:T,statuses:H})]})};var $r=s(25713),Br=s(50675);const Lr=()=>{var e,r,s,i;const[n,a]=(0,t.useState)([]),[o,d]=(0,t.useState)([]),[c,u]=(0,t.useState)(!0),[x,j]=(0,t.useState)(!1),[A,g]=(0,t.useState)({productId:"",discountedPrice:"",discountDuration:(0,F.A)(new Date(Date.now()+6048e5),"yyyy-MM-dd")}),[f,v]=(0,t.useState)({open:!1,id:null}),[b,w]=(0,t.useState)(""),[C,P]=(0,t.useState)(1),[E]=(0,t.useState)(10),[D,k]=(0,t.useState)("grid");(0,t.useEffect)((()=>{R()}),[]);const R=async()=>{try{u(!0);const e=await B.A.get("/products");a(e.data);const r=e.data.filter((e=>e.discountedPrice&&new Date(e.discountDuration)>new Date));d(r),u(!1)}catch(e){console.error("Erreur lors du chargement des donn\xe9es:",e),L.oR.error("Erreur lors du chargement des donn\xe9es"),u(!1)}},N=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;var r;e?g({productId:e._id,discountedPrice:(null===(r=e.discountedPrice)||void 0===r?void 0:r.toString())||"",discountDuration:e.discountDuration?(0,F.A)(new Date(e.discountDuration),"yyyy-MM-dd"):(0,F.A)(new Date(Date.now()+6048e5),"yyyy-MM-dd")}):g({productId:"",discountedPrice:"",discountDuration:(0,F.A)(new Date(Date.now()+6048e5),"yyyy-MM-dd")});j(!0)},I=()=>{j(!1)},W=e=>{const{name:r,value:s}=e.target;g({...A,[r]:s})},M=e=>{v({open:!0,id:e})},$=o.filter((e=>e.nom.toLowerCase().includes(b.toLowerCase())||e.Company_id.nom&&e.Company_id.nom.toLowerCase().includes(b.toLowerCase()))),O=$.slice((C-1)*E,C*E),T=(e,r)=>Math.round(100*(1-r/e));return c?(0,z.jsx)(l.A,{sx:{display:"flex",justifyContent:"center",mt:4},children:(0,z.jsx)(_.A,{})}):(0,z.jsxs)("div",{children:[(0,z.jsxs)(l.A,{sx:{display:"flex",justifyContent:"space-between",mb:3,alignItems:"center"},children:[(0,z.jsx)(m.A,{variant:"h4",children:"Gestion des Promotions"}),(0,z.jsxs)(l.A,{sx:{display:"flex",gap:2},children:[(0,z.jsx)(je.A,{size:"small",placeholder:"Rechercher...",value:b,onChange:e=>w(e.target.value),InputProps:{startAdornment:(0,z.jsx)(Ze.A,{position:"start",children:(0,z.jsx)(or.A,{})})},sx:{width:250}}),(0,z.jsx)(S.A,{variant:"contained",startIcon:(0,z.jsx)(Me.A,{}),onClick:()=>N(),children:"Ajouter une promotion"}),(0,z.jsx)(S.A,{variant:"outlined",onClick:()=>k("grid"===D?"table":"grid"),children:"grid"===D?"Vue tableau":"Vue grille"})]})]}),(0,z.jsxs)(l.A,{sx:{mb:2,display:"flex",alignItems:"center"},children:[(0,z.jsx)(X.A,{color:"error",sx:{mr:1}}),(0,z.jsxs)(m.A,{variant:"h6",children:[$.length," produits en promotion"]})]}),"grid"===D?(0,z.jsx)(z.Fragment,{children:(0,z.jsx)(be.Ay,{container:!0,spacing:3,children:O.length>0?O.map((e=>{var r;return(0,z.jsx)(be.Ay,{item:!0,xs:12,sm:6,md:3,children:(0,z.jsxs)(He.A,{sx:{height:"100%",display:"flex",flexDirection:"column"},children:[(0,z.jsxs)(l.A,{sx:{position:"relative"},children:[(0,z.jsx)(Ye.A,{component:"img",height:"140",image:e.mainPicture||"/placeholder-image.jpg",alt:e.nom}),(0,z.jsxs)(l.A,{sx:{position:"absolute",top:10,right:10,backgroundColor:"error.main",color:"white",padding:"4px 8px",borderRadius:1,fontWeight:"bold"},children:["-",T(e.oldPrice,e.discountedPrice),"%"]})]}),(0,z.jsxs)(Je.A,{sx:{flexGrow:1},children:[(0,z.jsx)(m.A,{gutterBottom:!0,variant:"h6",component:"div",noWrap:!0,children:e.nom}),(0,z.jsx)(m.A,{variant:"body2",color:"text.secondary",gutterBottom:!0,children:(null===(r=e.Company_id)||void 0===r?void 0:r.nom)||"N/A"}),(0,z.jsxs)(l.A,{sx:{display:"flex",alignItems:"center",mb:1},children:[(0,z.jsxs)(m.A,{variant:"body2",color:"text.secondary",sx:{textDecoration:"line-through",mr:1},children:[e.oldPrice," \u20ac"]}),(0,z.jsxs)(m.A,{variant:"body1",color:"error.main",fontWeight:"bold",children:[e.discountedPrice," \u20ac"]})]}),(0,z.jsx)(l.A,{sx:{mt:1},children:(0,z.jsx)(Oe.A,{label:`Jusqu'au ${(0,F.A)(new Date(e.discountDuration),"dd/MM/yyyy")}`,color:"primary",size:"small"})})]}),(0,z.jsxs)($r.A,{sx:{p:2},children:[(0,z.jsx)(p.A,{title:"Modifier la promotion",children:(0,z.jsx)(h.A,{onClick:()=>N(e),children:(0,z.jsx)(qe.A,{})})}),(0,z.jsx)(p.A,{title:"Supprimer la promotion",children:(0,z.jsx)(h.A,{color:"error",onClick:()=>M(e._id),children:(0,z.jsx)(q.A,{})})})]})]})},e._id)})):(0,z.jsx)(be.Ay,{item:!0,xs:12,children:(0,z.jsx)(me.A,{sx:{p:3,textAlign:"center"},children:(0,z.jsx)(m.A,{children:"Aucune promotion trouv\xe9e"})})})})}):(0,z.jsx)(Pe.A,{component:me.A,children:(0,z.jsxs)(Se.A,{children:[(0,z.jsx)(_e.A,{children:(0,z.jsxs)(Ee.A,{children:[(0,z.jsx)(De.A,{children:"Image"}),(0,z.jsx)(De.A,{children:"Produit"}),(0,z.jsx)(De.A,{children:"Marque"}),(0,z.jsx)(De.A,{children:"Prix normal"}),(0,z.jsx)(De.A,{children:"Prix promo"}),(0,z.jsx)(De.A,{children:"R\xe9duction"}),(0,z.jsx)(De.A,{children:"Jusqu'au"}),(0,z.jsx)(De.A,{children:"Actions"})]})}),(0,z.jsx)(ke.A,{children:O.length>0?O.map((e=>{var r;return(0,z.jsxs)(Ee.A,{children:[(0,z.jsx)(De.A,{children:(0,z.jsx)(l.A,{sx:{width:60,height:60},children:(0,z.jsx)("img",{src:e.mainPicture||"/placeholder-image.jpg",alt:e.nom,style:{width:"100%",height:"100%",objectFit:"cover",borderRadius:"4px"}})})}),(0,z.jsx)(De.A,{children:e.nom}),(0,z.jsx)(De.A,{children:(null===(r=e.Company_id)||void 0===r?void 0:r.nom)||"N/A"}),(0,z.jsxs)(De.A,{children:[e.oldPrice," \u20ac"]}),(0,z.jsxs)(De.A,{children:[e.discountedPrice," \u20ac"]}),(0,z.jsx)(De.A,{children:(0,z.jsx)(Oe.A,{label:`-${T(e.oldPrice,e.discountedPrice)}%`,color:"error",size:"small"})}),(0,z.jsx)(De.A,{children:(0,F.A)(new Date(e.discountDuration),"dd/MM/yyyy")}),(0,z.jsxs)(De.A,{children:[(0,z.jsx)(h.A,{onClick:()=>N(e),children:(0,z.jsx)(qe.A,{})}),(0,z.jsx)(h.A,{color:"error",onClick:()=>M(e._id),children:(0,z.jsx)(q.A,{})})]})]},e._id)})):(0,z.jsx)(Ee.A,{children:(0,z.jsx)(De.A,{colSpan:8,align:"center",children:"Aucune promotion trouv\xe9e"})})})]})}),(0,z.jsx)(l.A,{sx:{display:"flex",justifyContent:"center",mt:3},children:(0,z.jsx)(Qe.A,{count:Math.ceil($.length/E),page:C,onChange:(e,r)=>{P(r)},color:"primary",showFirstButton:!0,showLastButton:!0})}),(0,z.jsxs)(Re.A,{open:x,onClose:I,fullWidth:!0,maxWidth:"sm",children:[(0,z.jsx)(Ne.A,{children:A.productId?"Modifier la promotion":"Ajouter une promotion"}),(0,z.jsxs)(Ie.A,{children:[!A.productId&&(0,z.jsxs)(Te.A,{fullWidth:!0,margin:"normal",children:[(0,z.jsx)(Ue.A,{id:"product-select-label",children:"Produit"}),(0,z.jsx)(Ve.A,{labelId:"product-select-label",name:"productId",value:A.productId,onChange:W,label:"Produit",required:!0,children:n.filter((e=>!e.discountedPrice)).map((e=>{var r;return(0,z.jsxs)(y.A,{value:e._id,children:[e.nom," - ",e.oldPrice," \u20ac (",(null===(r=e.Company_id)||void 0===r?void 0:r.nom)||"N/A",")"]},e._id)}))})]}),A.productId&&n.find((e=>e._id===A.productId))&&(0,z.jsx)(l.A,{sx:{mb:2,mt:2},children:(0,z.jsxs)(l.A,{sx:{display:"flex",alignItems:"center",mb:2},children:[(0,z.jsx)(l.A,{sx:{width:60,height:60,mr:2},children:(0,z.jsx)("img",{src:(null===(e=n.find((e=>e._id===A.productId)))||void 0===e?void 0:e.mainPicture)||"/placeholder-image.jpg",alt:"Product",style:{width:"100%",height:"100%",objectFit:"cover",borderRadius:"4px"}})}),(0,z.jsxs)(l.A,{children:[(0,z.jsx)(m.A,{variant:"subtitle1",children:null===(r=n.find((e=>e._id===A.productId)))||void 0===r?void 0:r.nom}),(0,z.jsxs)(m.A,{variant:"body2",color:"text.secondary",children:["Prix normal: ",null===(s=n.find((e=>e._id===A.productId)))||void 0===s?void 0:s.oldPrice," \u20ac"]})]})]})}),(0,z.jsx)(je.A,{name:"discountedPrice",label:"Prix r\xe9duit (\u20ac)",fullWidth:!0,type:"number",margin:"normal",value:A.discountedPrice,onChange:W,required:!0,InputProps:{startAdornment:(0,z.jsx)(Ze.A,{position:"start",children:"\u20ac"})}}),(0,z.jsx)(je.A,{name:"discountDuration",label:"Valable jusqu'au",type:"date",fullWidth:!0,margin:"normal",value:A.discountDuration,onChange:W,InputLabelProps:{shrink:!0}}),A.productId&&A.discountedPrice&&(0,z.jsxs)(l.A,{sx:{mt:2,p:2,bgcolor:"background.paper",borderRadius:1},children:[(0,z.jsx)(m.A,{variant:"subtitle2",gutterBottom:!0,children:"Aper\xe7u de la promotion"}),(0,z.jsxs)(l.A,{sx:{display:"flex",alignItems:"center"},children:[(0,z.jsx)(Br.A,{color:"error",sx:{mr:1}}),(0,z.jsxs)(m.A,{children:["R\xe9duction de ",T((null===(i=n.find((e=>e._id===A.productId)))||void 0===i?void 0:i.oldPrice)||0,parseFloat(A.discountedPrice)),"%"]})]})]})]}),(0,z.jsxs)(We.A,{children:[(0,z.jsx)(S.A,{onClick:I,children:"Annuler"}),(0,z.jsx)(S.A,{onClick:async()=>{try{await B.A.put(`/products/${A.productId}/discount`,{discountedPrice:A.discountedPrice,discountDuration:A.discountDuration}),L.oR.success("Promotion appliqu\xe9e avec succ\xe8s"),I(),R()}catch(e){console.error("Erreur lors de l'application de la promotion:",e),L.oR.error("Erreur lors de l'application de la promotion")}},variant:"contained",disabled:!A.productId||!A.discountedPrice,children:A.productId?"Mettre \xe0 jour":"Ajouter"})]})]}),(0,z.jsx)($e,{open:f.open,title:"Confirmer la suppression",message:"\xcates-vous s\xfbr de vouloir supprimer cette promotion? Le produit sera remis au prix normal.",onConfirm:async()=>{try{await B.A.delete(`/products/${f.id}/discount`),L.oR.success("Promotion supprim\xe9e avec succ\xe8s"),R()}catch(e){console.error("Erreur lors de la suppression de la promotion:",e),L.oR.error("Erreur lors de la suppression de la promotion")}finally{v({open:!1,id:null})}},onCancel:()=>v({open:!1,id:null})})]})};var zr=s(29137),Or=s(94289),Tr=s(57326);const Ur=["#0088FE","#00C49F","#FFBB28","#FF8042","#A52A2A","#7B68EE","#FF6347","#20B2AA"];const Vr=function(){const[e,r]=(0,t.useState)(!0),[s,i]=(0,t.useState)(null),[n,a]=(0,t.useState)([]),[o,d]=(0,t.useState)([]),[c,u]=(0,t.useState)([]),[x,h]=(0,t.useState)("3months"),[p,j]=(0,t.useState)(0),[A,g]=(0,t.useState)([]),[f,v]=(0,t.useState)([]);(0,t.useEffect)((()=>{b()}),[]);const b=async()=>{try{r(!0);const e=await B.A.get("/stats");i(e.data);const s=await B.A.get("/categories");a(s.data);const t=await B.A.get("/companies");d(t.data);const n=await B.A.get("/products");u(n.data),w(n.data,s.data),C(n.data,t.data),r(!1)}catch(e){console.error("Erreur lors du chargement des donn\xe9es:",e),L.oR.error("Impossible de charger les donn\xe9es statistiques"),r(!1)}},w=(e,r)=>{const s=r.map((r=>{const s=e.filter((e=>e.categoriesa_id.some((e=>("object"===typeof e?e._id:e)===r._id)))).length;return{name:r.name,count:s}})).sort(((e,r)=>r.count-e.count));g(s)},C=(e,r)=>{const s=r.map((r=>{const s=e.filter((e=>("object"===typeof e.Company_id?e.Company_id._id:e.Company_id)===r._id)).length;return{name:r.nom,count:s}})).sort(((e,r)=>r.count-e.count));v(s)};return e?(0,z.jsx)(l.A,{sx:{display:"flex",justifyContent:"center",mt:4},children:(0,z.jsx)(_.A,{})}):(0,z.jsxs)("div",{children:[(0,z.jsxs)(l.A,{sx:{display:"flex",justifyContent:"space-between",mb:3},children:[(0,z.jsx)(m.A,{variant:"h4",children:"Statistiques et Analyses"}),(0,z.jsx)(S.A,{variant:"contained",startIcon:(0,z.jsx)(zr.A,{}),onClick:()=>{const e=Ar.Wp.book_new(),r=c.map((e=>({ID:e._id,Nom:e.nom,Description:e.description||"",Prix:e.oldPrice,"Prix remis\xe9":e.discountedPrice||"","Quantit\xe9":e.quantite||0,Entreprise:e.Company_id.nom||"","Cat\xe9gories":e.categoriesa_id.map((e=>e.name)).join(", "),"Sous-cat\xe9gories":e.subcategories_id.map((e=>e.name)).join(", "),"Date de cr\xe9ation":new Date(e.createdAt).toLocaleDateString("fr-FR")}))),s=Ar.Wp.json_to_sheet(r);Ar.Wp.book_append_sheet(e,s,"Produits");const t=n.map((e=>{var r;return{ID:e._id,Nom:e.name,Description:e.description||"","Nombre de produits":(null===(r=A.find((r=>r.name===e.name)))||void 0===r?void 0:r.count)||0}})),i=Ar.Wp.json_to_sheet(t);Ar.Wp.book_append_sheet(e,i,"Cat\xe9gories");const a=o.map((e=>{var r;return{ID:e._id,Nom:e.nom,"Nombre de produits":(null===(r=f.find((r=>r.name===e.nom)))||void 0===r?void 0:r.count)||0,"Cat\xe9gories":e.categories_id.map((e=>e.name)).join(", ")}})),l=Ar.Wp.json_to_sheet(a);Ar.Wp.book_append_sheet(e,l,"Entreprises"),Ar._h(e,`Catalogue_Export_${(0,F.A)(new Date,"yyyy-MM-dd")}.xlsx`),L.oR.success("Donn\xe9es export\xe9es avec succ\xe8s")},children:"Exporter en Excel"})]}),(0,z.jsxs)(sr.A,{value:p,onChange:(e,r)=>{j(r)},indicatorColor:"primary",textColor:"primary",centered:!0,sx:{mb:3},children:[(0,z.jsx)(tr.A,{icon:(0,z.jsx)(ir.A,{}),label:"Vue d'ensemble"}),(0,z.jsx)(tr.A,{icon:(0,z.jsx)(nr.A,{}),label:"Tendances"}),(0,z.jsx)(tr.A,{icon:(0,z.jsx)(ar.A,{}),label:"R\xe9partition"})]}),0===p&&(0,z.jsxs)(be.Ay,{container:!0,spacing:3,children:[(0,z.jsx)(be.Ay,{item:!0,xs:12,md:4,children:(0,z.jsx)(He.A,{sx:{height:"100%"},children:(0,z.jsxs)(Je.A,{children:[(0,z.jsx)(m.A,{variant:"h6",gutterBottom:!0,children:"R\xe9sum\xe9 du catalogue"}),(0,z.jsxs)(l.A,{sx:{mt:2},children:[(0,z.jsxs)(m.A,{variant:"body1",children:[(0,z.jsx)("strong",{children:"Nombre de cat\xe9gories:"})," ",(null===s||void 0===s?void 0:s.categories)||0]}),(0,z.jsxs)(m.A,{variant:"body1",children:[(0,z.jsx)("strong",{children:"Nombre d'entreprises:"})," ",(null===s||void 0===s?void 0:s.companies)||0]}),(0,z.jsxs)(m.A,{variant:"body1",children:[(0,z.jsx)("strong",{children:"Nombre de produits:"})," ",(null===s||void 0===s?void 0:s.products)||0]}),(0,z.jsxs)(m.A,{variant:"body1",children:[(0,z.jsx)("strong",{children:"Produits en promotion:"})," ",c.filter((e=>e.discountedPrice&&new Date(e.discountDuration)>new Date)).length]})]})]})})}),(0,z.jsx)(be.Ay,{item:!0,xs:12,md:8,children:(0,z.jsxs)(me.A,{sx:{p:3,height:"100%"},children:[(0,z.jsx)(m.A,{variant:"h6",gutterBottom:!0,children:"Top 5 cat\xe9gories par nombre de produits"}),(0,z.jsx)(gr.u,{width:"100%",height:300,children:(0,z.jsxs)(yr.E,{data:A.slice(0,5),margin:{top:20,right:30,left:20,bottom:5},children:[(0,z.jsx)(fr.d,{strokeDasharray:"3 3"}),(0,z.jsx)(vr.W,{dataKey:"name"}),(0,z.jsx)(br.h,{}),(0,z.jsx)(wr.m,{}),(0,z.jsx)(Cr.s,{}),(0,z.jsx)(Pr.y,{dataKey:"count",name:"Nombre de produits",fill:"#8884d8"})]})})]})}),(0,z.jsx)(be.Ay,{item:!0,xs:12,md:6,children:(0,z.jsxs)(me.A,{sx:{p:3},children:[(0,z.jsx)(m.A,{variant:"h6",gutterBottom:!0,children:"Top 5 entreprises par nombre de produits"}),(0,z.jsx)(gr.u,{width:"100%",height:300,children:(0,z.jsxs)(yr.E,{data:f.slice(0,5),margin:{top:20,right:30,left:20,bottom:5},children:[(0,z.jsx)(fr.d,{strokeDasharray:"3 3"}),(0,z.jsx)(vr.W,{dataKey:"name"}),(0,z.jsx)(br.h,{}),(0,z.jsx)(wr.m,{}),(0,z.jsx)(Cr.s,{}),(0,z.jsx)(Pr.y,{dataKey:"count",name:"Nombre de produits",fill:"#82ca9d"})]})})]})}),(0,z.jsx)(be.Ay,{item:!0,xs:12,md:6,children:(0,z.jsxs)(me.A,{sx:{p:3},children:[(0,z.jsx)(m.A,{variant:"h6",gutterBottom:!0,children:"R\xe9partition des produits par gamme de prix"}),(0,z.jsx)(gr.u,{width:"100%",height:300,children:(0,z.jsxs)(Sr.r,{children:[(0,z.jsx)(_r.F,{data:[{name:"< 10\u20ac",value:c.filter((e=>e.oldPrice<10)).length},{name:"10-50\u20ac",value:c.filter((e=>e.oldPrice>=10&&e.oldPrice<50)).length},{name:"50-100\u20ac",value:c.filter((e=>e.oldPrice>=50&&e.oldPrice<100)).length},{name:"100-500\u20ac",value:c.filter((e=>e.oldPrice>=100&&e.oldPrice<500)).length},{name:"> 500\u20ac",value:c.filter((e=>e.oldPrice>=500)).length}],cx:"50%",cy:"50%",labelLine:!1,outerRadius:100,fill:"#8884d8",dataKey:"value",label:e=>{let{name:r,percent:s}=e;return`${r} ${(100*s).toFixed(0)}%`},children:[{name:"< 10\u20ac",value:c.filter((e=>e.oldPrice<10)).length},{name:"10-50\u20ac",value:c.filter((e=>e.oldPrice>=10&&e.oldPrice<50)).length},{name:"50-100\u20ac",value:c.filter((e=>e.oldPrice>=50&&e.oldPrice<100)).length},{name:"100-500\u20ac",value:c.filter((e=>e.oldPrice>=100&&e.oldPrice<500)).length},{name:"> 500\u20ac",value:c.filter((e=>e.oldPrice>=500)).length}].map(((e,r)=>(0,z.jsx)(Er.f,{fill:Ur[r%Ur.length]},`cell-${r}`)))}),(0,z.jsx)(wr.m,{})]})})]})})]}),1===p&&(0,z.jsxs)(z.Fragment,{children:[(0,z.jsx)(l.A,{sx:{mb:3,display:"flex",justifyContent:"flex-end"},children:(0,z.jsxs)(Te.A,{sx:{minWidth:150},children:[(0,z.jsx)(Ue.A,{id:"period-label",children:"P\xe9riode"}),(0,z.jsxs)(Ve.A,{labelId:"period-label",value:x,onChange:e=>{h(e.target.value)},label:"P\xe9riode",children:[(0,z.jsx)(y.A,{value:"3months",children:"3 derniers mois"}),(0,z.jsx)(y.A,{value:"6months",children:"6 derniers mois"}),(0,z.jsx)(y.A,{value:"12months",children:"12 derniers mois"})]})]})}),(0,z.jsx)(be.Ay,{container:!0,spacing:3,children:(0,z.jsx)(be.Ay,{item:!0,xs:12,children:(0,z.jsxs)(me.A,{sx:{p:3},children:[(0,z.jsx)(m.A,{variant:"h6",gutterBottom:!0,children:"\xc9volution mensuelle"}),(0,z.jsx)(gr.u,{width:"100%",height:400,children:(0,z.jsxs)(Dr.b,{data:(()=>{const e=new Date;let r,s=[];switch(x){case"3months":default:r=3;break;case"6months":r=6;break;case"12months":r=12}for(let t=0;t<r;t++){const r=(0,jr.A)(e,t),i=((0,Or.A)(r),(0,Tr.A)(r),{name:(0,F.A)(r,"MMMM yyyy",{locale:$.A}),nouveauxProduits:Math.floor(20*Math.random()),produitsEnPromotion:Math.floor(15*Math.random()),visites:Math.floor(1e3*Math.random())+100});s.push(i)}return s.reverse()})(),margin:{top:20,right:30,left:20,bottom:5},children:[(0,z.jsx)(fr.d,{strokeDasharray:"3 3"}),(0,z.jsx)(vr.W,{dataKey:"name"}),(0,z.jsx)(br.h,{yAxisId:"left"}),(0,z.jsx)(br.h,{yAxisId:"right",orientation:"right"}),(0,z.jsx)(wr.m,{}),(0,z.jsx)(Cr.s,{}),(0,z.jsx)(kr.N,{yAxisId:"left",type:"monotone",dataKey:"nouveauxProduits",name:"Nouveaux produits",stroke:"#8884d8",activeDot:{r:8}}),(0,z.jsx)(kr.N,{yAxisId:"left",type:"monotone",dataKey:"produitsEnPromotion",name:"Produits en promotion",stroke:"#82ca9d"}),(0,z.jsx)(kr.N,{yAxisId:"right",type:"monotone",dataKey:"visites",name:"Visites (simulation)",stroke:"#ff7300"})]})})]})})})]}),2===p&&(0,z.jsxs)(be.Ay,{container:!0,spacing:3,children:[(0,z.jsx)(be.Ay,{item:!0,xs:12,md:6,children:(0,z.jsxs)(me.A,{sx:{p:3},children:[(0,z.jsx)(m.A,{variant:"h6",gutterBottom:!0,children:"R\xe9partition des produits par cat\xe9gorie"}),(0,z.jsx)(gr.u,{width:"100%",height:400,children:(0,z.jsxs)(Sr.r,{children:[(0,z.jsx)(_r.F,{data:A,cx:"50%",cy:"50%",labelLine:!1,outerRadius:150,fill:"#8884d8",dataKey:"count",label:e=>{let{name:r,percent:s}=e;return s>.05?`${r} ${(100*s).toFixed(0)}%`:""},children:A.map(((e,r)=>(0,z.jsx)(Er.f,{fill:Ur[r%Ur.length]},`cell-${r}`)))}),(0,z.jsx)(wr.m,{})]})})]})}),(0,z.jsx)(be.Ay,{item:!0,xs:12,md:6,children:(0,z.jsxs)(me.A,{sx:{p:3},children:[(0,z.jsx)(m.A,{variant:"h6",gutterBottom:!0,children:"R\xe9partition des produits par entreprise"}),(0,z.jsx)(gr.u,{width:"100%",height:400,children:(0,z.jsxs)(Sr.r,{children:[(0,z.jsx)(_r.F,{data:f,cx:"50%",cy:"50%",labelLine:!1,outerRadius:150,fill:"#8884d8",dataKey:"count",label:e=>{let{name:r,percent:s}=e;return s>.05?`${r} ${(100*s).toFixed(0)}%`:""},children:f.map(((e,r)=>(0,z.jsx)(Er.f,{fill:Ur[r%Ur.length]},`cell-${r}`)))}),(0,z.jsx)(wr.m,{})]})})]})}),(0,z.jsx)(be.Ay,{item:!0,xs:12,children:(0,z.jsxs)(me.A,{sx:{p:3},children:[(0,z.jsx)(m.A,{variant:"h6",gutterBottom:!0,children:"R\xe9partition des produits par niveau de stock"}),(0,z.jsx)(gr.u,{width:"100%",height:300,children:(0,z.jsxs)(yr.E,{data:[{name:"\xc9puis\xe9 (0)",value:c.filter((e=>0===e.quantite)).length},{name:"Faible (1-10)",value:c.filter((e=>e.quantite>0&&e.quantite<=10)).length},{name:"Moyen (11-50)",value:c.filter((e=>e.quantite>10&&e.quantite<=50)).length},{name:"\xc9lev\xe9 (>50)",value:c.filter((e=>e.quantite>50)).length}],margin:{top:20,right:30,left:20,bottom:5},children:[(0,z.jsx)(fr.d,{strokeDasharray:"3 3"}),(0,z.jsx)(vr.W,{dataKey:"name"}),(0,z.jsx)(br.h,{}),(0,z.jsx)(wr.m,{}),(0,z.jsx)(Cr.s,{}),(0,z.jsx)(Pr.y,{dataKey:"value",name:"Nombre de produits",fill:"#8884d8",children:[{name:"\xc9puis\xe9 (0)",value:c.filter((e=>0===e.quantite)).length},{name:"Faible (1-10)",value:c.filter((e=>e.quantite>0&&e.quantite<=10)).length},{name:"Moyen (11-50)",value:c.filter((e=>e.quantite>10&&e.quantite<=50)).length},{name:"\xc9lev\xe9 (>50)",value:c.filter((e=>e.quantite>50)).length}].map(((e,r)=>(0,z.jsx)(Er.f,{fill:Ur[r%Ur.length]},`cell-${r}`)))})]})})]})})]})]})};var Kr=s(72934);const Gr={superAdmin:"Super Admin",productManager:"Responsable des produits",orderManager:"Responsable des commandes",contentEditor:"\xc9diteur de contenu"},Hr=()=>{const{currentUser:e,updateProfile:r}=(0,T.A)(),[s,i]=(0,t.useState)(!1),[n,a]=(0,t.useState)({firstName:"",lastName:"",email:"",currentPassword:"",newPassword:"",confirmPassword:""}),[o,d]=(0,t.useState)("");(0,t.useEffect)((()=>{e&&a({...n,firstName:e.firstName||"",lastName:e.lastName||"",email:e.email||""})}),[e]);const c=e=>{const{name:r,value:s}=e.target;a({...n,[r]:s}),["currentPassword","newPassword","confirmPassword"].includes(r)&&d("")},u=e=>{const[r,s]=e.split(".");return`${{create:"Cr\xe9er",read:"Voir",update:"Modifier",delete:"Supprimer"}[s]||s} ${{products:"Produits",categories:"Cat\xe9gories",orders:"Commandes",companies:"Entreprises",admins:"Administrateurs"}[r]||r}`},x=e=>{switch(e){case"create":return"success";case"read":return"info";case"update":return"warning";case"delete":return"error";default:return"default"}};return e?(0,z.jsxs)(l.A,{sx:{p:3},children:[(0,z.jsx)(m.A,{variant:"h4",gutterBottom:!0,children:"Profil"}),(0,z.jsxs)(be.Ay,{container:!0,spacing:3,children:[(0,z.jsxs)(be.Ay,{item:!0,xs:12,md:4,children:[(0,z.jsx)(He.A,{children:(0,z.jsxs)(Je.A,{sx:{display:"flex",flexDirection:"column",alignItems:"center"},children:[(0,z.jsx)(j.A,{sx:{width:100,height:100,mb:2,bgcolor:"primary.main",fontSize:"3rem"},children:(0,z.jsx)(w.A,{fontSize:"inherit"})}),(0,z.jsx)(m.A,{variant:"h5",gutterBottom:!0,children:e.username}),(0,z.jsx)(Oe.A,{label:Gr[e.role]||e.role,color:"superAdmin"===e.role?"error":"primary",sx:{mb:2}}),(0,z.jsx)(m.A,{variant:"body2",color:"text.secondary",align:"center",children:`${e.firstName||""} ${e.lastName||""}`.trim()||"Nom non d\xe9fini"}),e.email&&(0,z.jsx)(m.A,{variant:"body2",color:"text.secondary",sx:{mt:1},children:e.email})]})}),(0,z.jsx)(He.A,{sx:{mt:3},children:(0,z.jsxs)(Je.A,{children:[(0,z.jsx)(m.A,{variant:"h6",gutterBottom:!0,children:"Permissions"}),"superAdmin"===e.role?(0,z.jsx)(pe.A,{severity:"info",sx:{mb:2},children:"En tant que Super Admin, vous avez acc\xe8s \xe0 toutes les fonctionnalit\xe9s."}):(0,z.jsxs)(z.Fragment,{children:[(0,z.jsx)(l.A,{sx:{display:"flex",flexWrap:"wrap",gap:1,mb:2},children:(()=>{if(!e||!e.permissions)return[];const r=[];return Object.entries(e.permissions).forEach((e=>{let[s,t]=e;Object.entries(t).forEach((e=>{let[t,i]=e;i&&r.push(`${s}.${t}`)}))})),r})().map((e=>{const[,r]=e.split(".");return(0,z.jsx)(Oe.A,{label:u(e),size:"small",color:x(r),variant:"outlined"},e)}))}),(0,z.jsx)(m.A,{variant:"caption",color:"text.secondary",children:"Ces permissions sont d\xe9termin\xe9es par votre r\xf4le. Contactez un Super Admin pour toute modification."})]})]})})]}),(0,z.jsx)(be.Ay,{item:!0,xs:12,md:8,children:(0,z.jsxs)(me.A,{sx:{p:3},children:[(0,z.jsx)(m.A,{variant:"h6",gutterBottom:!0,children:"Informations personnelles"}),(0,z.jsx)(g.A,{sx:{mb:3}}),(0,z.jsx)("form",{onSubmit:async e=>{if(e.preventDefault(),n.newPassword&&n.newPassword!==n.confirmPassword?(d("Les mots de passe ne correspondent pas."),0):!n.newPassword||n.currentPassword||(d("Veuillez saisir votre mot de passe actuel pour confirmer le changement."),0)){i(!0);try{const e={firstName:n.firstName,lastName:n.lastName,email:n.email};n.newPassword&&(e.currentPassword=n.currentPassword,e.newPassword=n.newPassword);const s=await r(e);s.success?(L.oR.success(s.message),a({...n,currentPassword:"",newPassword:"",confirmPassword:""})):(L.oR.error(s.message),s.message.includes("mot de passe actuel")&&d(s.message))}catch(s){console.error("Erreur lors de la mise \xe0 jour du profil:",s),L.oR.error("Une erreur est survenue lors de la mise \xe0 jour du profil.")}finally{i(!1)}}},children:(0,z.jsxs)(be.Ay,{container:!0,spacing:2,children:[(0,z.jsx)(be.Ay,{item:!0,xs:12,sm:6,children:(0,z.jsx)(je.A,{fullWidth:!0,label:"Pr\xe9nom",name:"firstName",value:n.firstName,onChange:c})}),(0,z.jsx)(be.Ay,{item:!0,xs:12,sm:6,children:(0,z.jsx)(je.A,{fullWidth:!0,label:"Nom",name:"lastName",value:n.lastName,onChange:c})}),(0,z.jsx)(be.Ay,{item:!0,xs:12,children:(0,z.jsx)(je.A,{fullWidth:!0,label:"Email",name:"email",type:"email",value:n.email,onChange:c})}),(0,z.jsxs)(be.Ay,{item:!0,xs:12,children:[(0,z.jsx)(m.A,{variant:"h6",gutterBottom:!0,sx:{mt:2},children:"Changer de mot de passe"}),(0,z.jsx)(g.A,{sx:{mb:3}})]}),(0,z.jsx)(be.Ay,{item:!0,xs:12,children:(0,z.jsx)(je.A,{fullWidth:!0,label:"Mot de passe actuel",name:"currentPassword",type:"password",value:n.currentPassword,onChange:c})}),(0,z.jsx)(be.Ay,{item:!0,xs:12,sm:6,children:(0,z.jsx)(je.A,{fullWidth:!0,label:"Nouveau mot de passe",name:"newPassword",type:"password",value:n.newPassword,onChange:c})}),(0,z.jsx)(be.Ay,{item:!0,xs:12,sm:6,children:(0,z.jsx)(je.A,{fullWidth:!0,label:"Confirmer le nouveau mot de passe",name:"confirmPassword",type:"password",value:n.confirmPassword,onChange:c,error:!!o,helperText:o})}),(0,z.jsx)(be.Ay,{item:!0,xs:12,children:(0,z.jsx)(l.A,{sx:{mt:2,display:"flex",justifyContent:"flex-end"},children:(0,z.jsx)(S.A,{type:"submit",variant:"contained",color:"primary",startIcon:(0,z.jsx)(Kr.A,{}),disabled:s,children:s?"Enregistrement...":"Enregistrer les modifications"})})})]})})]})})]})]}):(0,z.jsx)(l.A,{sx:{p:3},children:(0,z.jsx)(pe.A,{severity:"info",children:"Chargement des informations du profil..."})})};var Yr=s(16497),Jr=s(80957),Qr=s(73759),Zr=s(41770),Xr=s(63338);const es=[{value:"superAdmin",label:"Super Admin",description:"Acc\xe8s complet \xe0 toutes les fonctionnalit\xe9s"},{value:"productManager",label:"Responsable des produits",description:"Gestion des produits uniquement"},{value:"orderManager",label:"Responsable des commandes",description:"Gestion des commandes uniquement"},{value:"contentEditor",label:"\xc9diteur de contenu",description:"Gestion des cat\xe9gories et descriptions"}],rs=()=>{const{currentUser:e}=(0,T.A)(),[r,s]=(0,t.useState)([]),[i,n]=(0,t.useState)(!0),[a,o]=(0,t.useState)(!1),[d,c]=(0,t.useState)("add"),[u,x]=(0,t.useState)(null),[j,A]=(0,t.useState)({username:"",password:"",firstName:"",lastName:"",email:"",role:"contentEditor",active:!0}),[g,f]=(0,t.useState)(!1),[v,b]=(0,t.useState)(null);(0,t.useEffect)((()=>{w()}),[]);const w=async()=>{try{n(!0);const e=await Xr.A.get("/auth/admins");s(e.data)}catch(e){console.error("Erreur lors du chargement des administrateurs:",e),L.oR.error("Erreur lors du chargement des administrateurs")}finally{n(!1)}},C=function(e){let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;c(e),x(r),A("edit"===e&&r?{username:r.username,password:"",firstName:r.firstName||"",lastName:r.lastName||"",email:r.email||"",role:r.role,active:!1!==r.active}:{username:"",password:"",firstName:"",lastName:"",email:"",role:"contentEditor",active:!0}),o(!0)},P=()=>{o(!1),x(null)},_=e=>{const{name:r,value:s,type:t,checked:i}=e.target;A({...j,[r]:"checkbox"===t?i:s})},E=()=>{f(!1),b(null)},D=e=>{const r=es.find((r=>r.value===e));return r?r.label:e},k=r=>e&&e.id===r;return(0,z.jsxs)(l.A,{sx:{padding:3},children:[(0,z.jsxs)(l.A,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:3},children:[(0,z.jsx)(m.A,{variant:"h4",component:"h1",children:"Gestion des administrateurs"}),(0,z.jsx)(S.A,{variant:"contained",color:"primary",startIcon:(0,z.jsx)(Me.A,{}),onClick:()=>C("add"),children:"Ajouter un administrateur"})]}),(0,z.jsx)(me.A,{sx:{width:"100%",overflow:"hidden"},children:(0,z.jsx)(Pe.A,{sx:{maxHeight:"calc(100vh - 200px)"},children:(0,z.jsxs)(Se.A,{stickyHeader:!0,children:[(0,z.jsx)(_e.A,{children:(0,z.jsxs)(Ee.A,{children:[(0,z.jsx)(De.A,{children:"Nom d'utilisateur"}),(0,z.jsx)(De.A,{children:"Nom complet"}),(0,z.jsx)(De.A,{children:"Email"}),(0,z.jsx)(De.A,{children:"R\xf4le"}),(0,z.jsx)(De.A,{children:"Statut"}),(0,z.jsx)(De.A,{children:"Derni\xe8re connexion"}),(0,z.jsx)(De.A,{align:"center",children:"Actions"})]})}),(0,z.jsx)(ke.A,{children:i?(0,z.jsx)(Ee.A,{children:(0,z.jsx)(De.A,{colSpan:7,align:"center",children:"Chargement en cours..."})}):0===r.length?(0,z.jsx)(Ee.A,{children:(0,z.jsx)(De.A,{colSpan:7,align:"center",children:"Aucun administrateur trouv\xe9"})}):r.map((e=>(0,z.jsxs)(Ee.A,{hover:!0,children:[(0,z.jsxs)(De.A,{children:[e.username,k(e._id)&&(0,z.jsx)(Oe.A,{size:"small",label:"Vous",color:"primary",sx:{ml:1}})]}),(0,z.jsx)(De.A,{children:`${e.firstName||""} ${e.lastName||""}`}),(0,z.jsx)(De.A,{children:e.email||"-"}),(0,z.jsx)(De.A,{children:(0,z.jsx)(Oe.A,{label:D(e.role),color:"superAdmin"===e.role?"error":"primary",variant:"superAdmin"===e.role?"filled":"outlined"})}),(0,z.jsx)(De.A,{children:!1!==e.active?(0,z.jsx)(Oe.A,{icon:(0,z.jsx)(Qr.A,{}),label:"Actif",color:"success",variant:"outlined",size:"small"}):(0,z.jsx)(Oe.A,{icon:(0,z.jsx)(Zr.A,{}),label:"Inactif",color:"error",variant:"outlined",size:"small"})}),(0,z.jsx)(De.A,{children:e.lastLogin?new Date(e.lastLogin).toLocaleString():"Jamais connect\xe9"}),(0,z.jsxs)(De.A,{align:"center",children:[(0,z.jsx)(p.A,{title:"Modifier",children:(0,z.jsx)(h.A,{color:"primary",onClick:()=>C("edit",e),children:(0,z.jsx)(qe.A,{})})}),!k(e._id)&&(0,z.jsx)(p.A,{title:"Supprimer",children:(0,z.jsx)(h.A,{color:"error",onClick:()=>(e=>{b(e),f(!0)})(e),children:(0,z.jsx)(q.A,{})})})]})]},e._id)))})]})})}),(0,z.jsxs)(Re.A,{open:a,onClose:P,maxWidth:"sm",fullWidth:!0,children:[(0,z.jsx)(Ne.A,{children:"add"===d?"Ajouter un administrateur":"Modifier l'administrateur"}),(0,z.jsx)(Ie.A,{children:(0,z.jsxs)(be.Ay,{container:!0,spacing:2,sx:{mt:1},children:[(0,z.jsx)(be.Ay,{item:!0,xs:12,children:(0,z.jsx)(je.A,{name:"username",label:"Nom d'utilisateur",value:j.username,onChange:_,fullWidth:!0,required:!0,disabled:"edit"===d})}),(0,z.jsx)(be.Ay,{item:!0,xs:12,children:(0,z.jsx)(je.A,{name:"password",label:"add"===d?"Mot de passe":"Nouveau mot de passe (laisser vide pour ne pas modifier)",type:"password",value:j.password,onChange:_,fullWidth:!0,required:"add"===d})}),(0,z.jsx)(be.Ay,{item:!0,xs:6,children:(0,z.jsx)(je.A,{name:"firstName",label:"Pr\xe9nom",value:j.firstName,onChange:_,fullWidth:!0})}),(0,z.jsx)(be.Ay,{item:!0,xs:6,children:(0,z.jsx)(je.A,{name:"lastName",label:"Nom",value:j.lastName,onChange:_,fullWidth:!0})}),(0,z.jsx)(be.Ay,{item:!0,xs:12,children:(0,z.jsx)(je.A,{name:"email",label:"Email",type:"email",value:j.email,onChange:_,fullWidth:!0})}),(0,z.jsx)(be.Ay,{item:!0,xs:12,children:(0,z.jsxs)(Te.A,{fullWidth:!0,children:[(0,z.jsx)(Ue.A,{id:"role-label",children:"R\xf4le"}),(0,z.jsx)(Ve.A,{labelId:"role-label",name:"role",value:j.role,onChange:_,label:"R\xf4le",children:es.map((e=>(0,z.jsx)(y.A,{value:e.value,children:(0,z.jsxs)(l.A,{children:[(0,z.jsx)(m.A,{variant:"body1",children:e.label}),(0,z.jsx)(m.A,{variant:"caption",color:"textSecondary",children:e.description})]})},e.value)))})]})}),"edit"===d&&(0,z.jsx)(be.Ay,{item:!0,xs:12,children:(0,z.jsx)(Yr.A,{control:(0,z.jsx)(Jr.A,{checked:j.active,onChange:_,name:"active",color:"primary"}),label:"Actif"})})]})}),(0,z.jsxs)(We.A,{children:[(0,z.jsx)(S.A,{onClick:P,children:"Annuler"}),(0,z.jsx)(S.A,{onClick:async()=>{try{if(!j.username)return void L.oR.error("Le nom d'utilisateur est requis");if("add"===d&&!j.password)return void L.oR.error("Le mot de passe est requis pour un nouvel administrateur");if("add"===d)await Xr.A.post("/auth/admins",j),L.oR.success("Administrateur cr\xe9\xe9 avec succ\xe8s");else{const e={...j};e.password||delete e.password,await Xr.A.put(`/auth/admins/${u._id}`,e),L.oR.success("Administrateur mis \xe0 jour avec succ\xe8s")}P(),w()}catch(e){console.error("Erreur lors de l'op\xe9ration:",e),e.response&&e.response.data&&e.response.data.message?L.oR.error(e.response.data.message):L.oR.error("Une erreur est survenue")}},variant:"contained",color:"primary",children:"add"===d?"Cr\xe9er":"Mettre \xe0 jour"})]})]}),(0,z.jsxs)(Re.A,{open:g,onClose:E,children:[(0,z.jsx)(Ne.A,{children:"Confirmer la suppression"}),(0,z.jsx)(Ie.A,{children:(0,z.jsxs)(m.A,{children:["\xcates-vous s\xfbr de vouloir supprimer l'administrateur",(0,z.jsx)("strong",{children:null===v||void 0===v?void 0:v.username})," ? Cette action est irr\xe9versible."]})}),(0,z.jsxs)(We.A,{children:[(0,z.jsx)(S.A,{onClick:E,children:"Annuler"}),(0,z.jsx)(S.A,{onClick:async()=>{if(v)try{await Xr.A.delete(`/auth/admins/${v._id}`),L.oR.success("Administrateur supprim\xe9 avec succ\xe8s"),w()}catch(e){console.error("Erreur lors de la suppression:",e),e.response&&e.response.data&&e.response.data.message?L.oR.error(e.response.data.message):L.oR.error("Une erreur est survenue lors de la suppression")}finally{E()}},color:"error",variant:"contained",children:"Supprimer"})]})]})]})},ss={getNotifications:async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};try{return(await B.A.get("/notifications",{params:e})).data}catch(r){throw console.error("Erreur lors de la r\xe9cup\xe9ration des notifications:",r),r}},markAsRead:async e=>{try{return(await B.A.patch(`/notifications/${e}/read`)).data}catch(r){throw console.error("Erreur lors de la mise \xe0 jour de la notification:",r),r}},markAllAsRead:async()=>{try{return(await B.A.patch("/notifications/read-all")).data}catch(e){throw console.error("Erreur lors de la mise \xe0 jour des notifications:",e),e}},deleteNotification:async e=>{try{return(await B.A.delete(`/notifications/${e}`)).data}catch(r){throw console.error("Erreur lors de la suppression de la notification:",r),r}},getUnreadCount:async()=>{try{return(await B.A.get("/notifications",{params:{limit:1,read:!1}})).data.unreadCount}catch(e){throw console.error("Erreur lors de la r\xe9cup\xe9ration du nombre de notifications:",e),e}}};function ts(e){const{children:r,value:s,index:t,...i}=e;return(0,z.jsx)("div",{role:"tabpanel",hidden:s!==t,id:`settings-tabpanel-${t}`,"aria-labelledby":`settings-tab-${t}`,...i,children:s===t&&(0,z.jsx)(l.A,{sx:{py:3},children:r})})}const is=function(){const[e,r]=(0,t.useState)(0),[s,i]=(0,t.useState)({notificationsEnabled:!0,emailNotifications:!1,darkMode:!1,language:"fr",securityAlerts:!0,twoFactorAuth:!1}),[n,a]=(0,t.useState)(!0),[o,d]=(0,t.useState)([]),[c,u]=(0,t.useState)(1),[x,p]=(0,t.useState)(0),[j,A]=(0,t.useState)(!1),[y,b]=(0,t.useState)({currentPassword:"",newPassword:"",confirmPassword:""}),[w,C]=(0,t.useState)(""),[P,M]=(0,t.useState)(""),{currentUser:B,updateProfile:O}=(0,T.A)();(0,t.useEffect)((()=>{setTimeout((()=>{a(!1)}),1e3),U()}),[c]);const U=async()=>{try{A(!0);const e=10*(c-1),r=await ss.getNotifications({limit:10,skip:e});d(r.data),p(r.total)}catch(e){console.error("Erreur lors du chargement des notifications:",e),L.oR.error("Erreur lors du chargement des notifications")}finally{A(!1)}},V=e=>{const{name:r,checked:s}=e.target;i((e=>({...e,[r]:s}))),L.oR.success(`Param\xe8tre ${r} mis \xe0 jour`)},K=e=>{const{name:r,value:s}=e.target;b((e=>({...e,[r]:s})))},G=e=>{switch(e){case"info":default:return(0,z.jsx)(k.A,{color:"info"});case"warning":return(0,z.jsx)(R.A,{color:"warning"});case"error":return(0,z.jsx)(N.A,{color:"error"});case"success":return(0,z.jsx)(I.A,{color:"success"})}};return n?(0,z.jsx)(l.A,{sx:{display:"flex",justifyContent:"center",mt:4},children:(0,z.jsx)(_.A,{})}):(0,z.jsxs)(l.A,{children:[(0,z.jsx)(m.A,{variant:"h4",gutterBottom:!0,children:"Param\xe8tres"}),(0,z.jsxs)(me.A,{sx:{mt:3},children:[(0,z.jsxs)(sr.A,{value:e,onChange:(e,s)=>{r(s)},sx:{borderBottom:1,borderColor:"divider"},centered:!0,children:[(0,z.jsx)(tr.A,{label:"Profil"}),(0,z.jsx)(tr.A,{label:"Notifications"}),(0,z.jsx)(tr.A,{label:"Apparence"}),(0,z.jsx)(tr.A,{label:"S\xe9curit\xe9"})]}),(0,z.jsx)(ts,{value:e,index:0,children:(0,z.jsx)(l.A,{sx:{p:2},children:(0,z.jsxs)(be.Ay,{container:!0,spacing:3,children:[(0,z.jsxs)(be.Ay,{item:!0,xs:12,children:[(0,z.jsx)(m.A,{variant:"h6",gutterBottom:!0,children:"Informations personnelles"}),(0,z.jsx)(g.A,{sx:{mb:3}})]}),(0,z.jsx)(be.Ay,{item:!0,xs:12,md:6,children:(0,z.jsx)(je.A,{fullWidth:!0,label:"Nom d'utilisateur",value:(null===B||void 0===B?void 0:B.username)||"",disabled:!0,variant:"outlined",margin:"normal"})}),(0,z.jsx)(be.Ay,{item:!0,xs:12,md:6,children:(0,z.jsx)(je.A,{fullWidth:!0,label:"Email",value:(null===B||void 0===B?void 0:B.email)||"",variant:"outlined",margin:"normal"})}),(0,z.jsx)(be.Ay,{item:!0,xs:12,md:6,children:(0,z.jsx)(je.A,{fullWidth:!0,label:"Pr\xe9nom",value:(null===B||void 0===B?void 0:B.firstName)||"",variant:"outlined",margin:"normal"})}),(0,z.jsx)(be.Ay,{item:!0,xs:12,md:6,children:(0,z.jsx)(je.A,{fullWidth:!0,label:"Nom",value:(null===B||void 0===B?void 0:B.lastName)||"",variant:"outlined",margin:"normal"})}),(0,z.jsx)(be.Ay,{item:!0,xs:12,children:(0,z.jsx)(l.A,{sx:{display:"flex",justifyContent:"flex-end",mt:2},children:(0,z.jsx)(S.A,{variant:"contained",color:"primary",children:"Enregistrer les modifications"})})})]})})}),(0,z.jsx)(ts,{value:e,index:1,children:(0,z.jsx)(l.A,{sx:{p:2},children:(0,z.jsxs)(be.Ay,{container:!0,spacing:3,children:[(0,z.jsxs)(be.Ay,{item:!0,xs:12,children:[(0,z.jsx)(m.A,{variant:"h6",gutterBottom:!0,children:"Param\xe8tres de notification"}),(0,z.jsx)(g.A,{sx:{mb:3}})]}),(0,z.jsx)(be.Ay,{item:!0,xs:12,children:(0,z.jsx)(He.A,{sx:{mb:3},children:(0,z.jsxs)(Je.A,{children:[(0,z.jsx)(m.A,{variant:"subtitle1",gutterBottom:!0,children:"Options de notification"}),(0,z.jsx)(Yr.A,{control:(0,z.jsx)(Jr.A,{checked:s.notificationsEnabled,onChange:V,name:"notificationsEnabled",color:"primary"}),label:"Activer les notifications"}),(0,z.jsx)(Yr.A,{control:(0,z.jsx)(Jr.A,{checked:s.emailNotifications,onChange:V,name:"emailNotifications",color:"primary",disabled:!s.notificationsEnabled}),label:"Recevoir les notifications par email"})]})})}),(0,z.jsxs)(be.Ay,{item:!0,xs:12,children:[(0,z.jsxs)(l.A,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:2},children:[(0,z.jsx)(m.A,{variant:"subtitle1",children:"Historique des notifications"}),(0,z.jsx)(S.A,{startIcon:(0,z.jsx)(W.A,{}),onClick:async()=>{try{await ss.markAllAsRead(),d(o.map((e=>({...e,read:!0})))),L.oR.success("Toutes les notifications ont \xe9t\xe9 marqu\xe9es comme lues")}catch(e){console.error("Erreur lors de la mise \xe0 jour des notifications:",e),L.oR.error("Erreur lors de la mise \xe0 jour des notifications")}},disabled:o.every((e=>e.read)),children:"Tout marquer comme lu"})]}),j?(0,z.jsx)(l.A,{sx:{display:"flex",justifyContent:"center",py:3},children:(0,z.jsx)(_.A,{size:32})}):0===o.length?(0,z.jsx)(pe.A,{severity:"info",children:"Aucune notification"}):(0,z.jsx)(E.A,{children:o.map((e=>(0,z.jsxs)(D.Ay,{sx:{backgroundColor:e.read?"transparent":"rgba(0, 0, 0, 0.04)",borderRadius:1,mb:1},secondaryAction:(0,z.jsx)(h.A,{edge:"end","aria-label":"delete",onClick:()=>(async e=>{try{await ss.deleteNotification(e),d(o.filter((r=>r._id!==e))),p((e=>e-1)),L.oR.success("Notification supprim\xe9e")}catch(r){console.error("Erreur lors de la suppression de la notification:",r),L.oR.error("Erreur lors de la suppression de la notification")}})(e._id),children:(0,z.jsx)(q.A,{})}),children:[(0,z.jsx)(f.A,{children:G(e.type)}),(0,z.jsx)(v.A,{primary:e.message,secondary:(0,z.jsxs)(z.Fragment,{children:[(0,F.A)(new Date(e.createdAt),"PPP \xe0 p",{locale:$.A}),!e.read&&(0,z.jsx)(S.A,{size:"small",sx:{ml:2},onClick:()=>(async e=>{try{await ss.markAsRead(e),d(o.map((r=>r._id===e?{...r,read:!0}:r))),L.oR.success("Notification marqu\xe9e comme lue")}catch(r){console.error("Erreur lors de la mise \xe0 jour de la notification:",r),L.oR.error("Erreur lors de la mise \xe0 jour de la notification")}})(e._id),children:"Marquer comme lu"})]}),primaryTypographyProps:{fontWeight:e.read?"normal":"bold"}})]},e._id)))}),x>10&&(0,z.jsxs)(l.A,{sx:{display:"flex",justifyContent:"center",mt:3},children:[(0,z.jsx)(S.A,{disabled:1===c,onClick:()=>u((e=>e-1)),children:"Pr\xe9c\xe9dent"}),(0,z.jsxs)(m.A,{sx:{mx:2},children:["Page ",c," sur ",Math.ceil(x/10)]}),(0,z.jsx)(S.A,{disabled:c>=Math.ceil(x/10),onClick:()=>u((e=>e+1)),children:"Suivant"})]})]})]})})}),(0,z.jsx)(ts,{value:e,index:2,children:(0,z.jsx)(l.A,{sx:{p:2},children:(0,z.jsxs)(be.Ay,{container:!0,spacing:3,children:[(0,z.jsxs)(be.Ay,{item:!0,xs:12,children:[(0,z.jsx)(m.A,{variant:"h6",gutterBottom:!0,children:"Param\xe8tres d'affichage"}),(0,z.jsx)(g.A,{sx:{mb:3}})]}),(0,z.jsx)(be.Ay,{item:!0,xs:12,children:(0,z.jsx)(He.A,{children:(0,z.jsxs)(Je.A,{children:[(0,z.jsx)(m.A,{variant:"subtitle1",gutterBottom:!0,children:"Th\xe8me"}),(0,z.jsx)(Yr.A,{control:(0,z.jsx)(Jr.A,{checked:s.darkMode,onChange:V,name:"darkMode",color:"primary"}),label:"Mode sombre"}),(0,z.jsx)(m.A,{variant:"subtitle1",gutterBottom:!0,sx:{mt:3},children:"Langue"}),(0,z.jsxs)(je.A,{select:!0,label:"Langue",value:s.language,onChange:e=>{i((r=>({...r,language:e.target.value}))),L.oR.success("Langue mise \xe0 jour")},SelectProps:{native:!0},fullWidth:!0,variant:"outlined",sx:{mt:1},children:[(0,z.jsx)("option",{value:"fr",children:"Fran\xe7ais"}),(0,z.jsx)("option",{value:"en",children:"English"}),(0,z.jsx)("option",{value:"es",children:"Espa\xf1ol"}),(0,z.jsx)("option",{value:"de",children:"Deutsch"}),(0,z.jsx)("option",{value:"ar",children:"\u0627\u0644\u0639\u0631\u0628\u064a\u0629"})]})]})})})]})})}),(0,z.jsx)(ts,{value:e,index:3,children:(0,z.jsx)(l.A,{sx:{p:2},children:(0,z.jsxs)(be.Ay,{container:!0,spacing:3,children:[(0,z.jsxs)(be.Ay,{item:!0,xs:12,children:[(0,z.jsx)(m.A,{variant:"h6",gutterBottom:!0,children:"Param\xe8tres de s\xe9curit\xe9"}),(0,z.jsx)(g.A,{sx:{mb:3}})]}),(0,z.jsx)(be.Ay,{item:!0,xs:12,md:6,children:(0,z.jsx)(He.A,{children:(0,z.jsxs)(Je.A,{children:[(0,z.jsx)(m.A,{variant:"subtitle1",gutterBottom:!0,children:"Changement de mot de passe"}),w&&(0,z.jsx)(pe.A,{severity:"error",sx:{mb:2},children:w}),P&&(0,z.jsx)(pe.A,{severity:"success",sx:{mb:2},children:P}),(0,z.jsxs)("form",{onSubmit:async e=>{if(e.preventDefault(),C(""),M(""),y.newPassword===y.confirmPassword)if(y.newPassword.length<8)C("Le mot de passe doit contenir au moins 8 caract\xe8res");else try{await new Promise((e=>setTimeout(e,1e3))),M("Mot de passe mis \xe0 jour avec succ\xe8s"),b({currentPassword:"",newPassword:"",confirmPassword:""})}catch(r){console.error("Erreur lors du changement de mot de passe:",r),C("Erreur lors du changement de mot de passe")}else C("Les mots de passe ne correspondent pas")},children:[(0,z.jsx)(je.A,{fullWidth:!0,label:"Mot de passe actuel",type:"password",name:"currentPassword",value:y.currentPassword,onChange:K,variant:"outlined",margin:"normal",required:!0}),(0,z.jsx)(je.A,{fullWidth:!0,label:"Nouveau mot de passe",type:"password",name:"newPassword",value:y.newPassword,onChange:K,variant:"outlined",margin:"normal",required:!0}),(0,z.jsx)(je.A,{fullWidth:!0,label:"Confirmer le nouveau mot de passe",type:"password",name:"confirmPassword",value:y.confirmPassword,onChange:K,variant:"outlined",margin:"normal",required:!0}),(0,z.jsx)(S.A,{type:"submit",variant:"contained",color:"primary",fullWidth:!0,sx:{mt:2},children:"Changer le mot de passe"})]})]})})}),(0,z.jsx)(be.Ay,{item:!0,xs:12,md:6,children:(0,z.jsx)(He.A,{children:(0,z.jsxs)(Je.A,{children:[(0,z.jsx)(m.A,{variant:"subtitle1",gutterBottom:!0,children:"S\xe9curit\xe9 du compte"}),(0,z.jsx)(Yr.A,{control:(0,z.jsx)(Jr.A,{checked:s.securityAlerts,onChange:V,name:"securityAlerts",color:"primary"}),label:"Notifications de s\xe9curit\xe9"}),(0,z.jsx)(Yr.A,{control:(0,z.jsx)(Jr.A,{checked:s.twoFactorAuth,onChange:V,name:"twoFactorAuth",color:"primary"}),label:"Authentification \xe0 deux facteurs"}),s.twoFactorAuth&&(0,z.jsx)(pe.A,{severity:"info",sx:{mt:2},children:"L'authentification \xe0 deux facteurs est activ\xe9e. Une \xe9tape suppl\xe9mentaire de v\xe9rification sera requise lors de la connexion."})]})})})]})})})]})]})},ns=e=>{let{children:r,requiredRole:s=null,requiredPermission:t=null,allowSuperAdmin:n=!0}=e;const{currentUser:a,hasPermission:o,isLoading:l}=(0,T.A)(),d=(0,i.zy)();if(l)return(0,z.jsx)("div",{children:"Chargement..."});if(!a)return(0,z.jsx)(i.C5,{to:"/admin/login",state:{from:d},replace:!0});if("orderManager"===s&&"productManager"===a.role)return(0,z.jsx)(i.C5,{to:"/admin/dashboard",replace:!0});if("productManager"===s&&"orderManager"===a.role)return(0,z.jsx)(i.C5,{to:"/admin/dashboard",replace:!0});if("contentEditor"===s&&("productManager"===a.role||"orderManager"===a.role))return(0,z.jsx)(i.C5,{to:"/admin/dashboard",replace:!0});if(s&&a.role!==s&&(!n||"superAdmin"!==a.role))return(0,z.jsx)(i.C5,{to:"/admin/dashboard",replace:!0});if(t){const{resource:e,action:r}=t;if(!o(e,r))return(0,z.jsx)(i.C5,{to:"/admin/dashboard",replace:!0})}return r};const as=function(){return(0,z.jsxs)(i.BV,{children:[(0,z.jsx)(i.qh,{path:"login",element:(0,z.jsx)(ve,{})}),(0,z.jsx)(i.qh,{path:"dashboard",element:(0,z.jsx)(ns,{children:(0,z.jsx)(xe,{children:(0,z.jsx)(Ce,{})})})}),(0,z.jsx)(i.qh,{path:"categories",element:(0,z.jsx)(ns,{requiredPermission:{resource:"categories",action:"read"},children:(0,z.jsx)(xe,{children:(0,z.jsx)(Le,{})})})}),(0,z.jsx)(i.qh,{path:"subcategories",element:(0,z.jsx)(ns,{requiredPermission:{resource:"categories",action:"read"},children:(0,z.jsx)(xe,{children:(0,z.jsx)(ze,{})})})}),(0,z.jsx)(i.qh,{path:"companies",element:(0,z.jsx)(ns,{requiredPermission:{resource:"companies",action:"read"},children:(0,z.jsx)(xe,{children:(0,z.jsx)(Ge,{})})})}),(0,z.jsx)(i.qh,{path:"products",element:(0,z.jsx)(ns,{requiredPermission:{resource:"products",action:"read"},children:(0,z.jsx)(xe,{children:(0,z.jsx)(rr,{})})})}),(0,z.jsx)(i.qh,{path:"promotions",element:(0,z.jsx)(ns,{requiredPermission:{resource:"products",action:"update"},children:(0,z.jsx)(xe,{children:(0,z.jsx)(Lr,{})})})}),(0,z.jsx)(i.qh,{path:"orders",element:(0,z.jsx)(ns,{requiredPermission:{resource:"orders",action:"read"},requiredRole:"orderManager",allowSuperAdmin:!0,children:(0,z.jsx)(xe,{children:(0,z.jsx)(Fr,{})})})}),(0,z.jsx)(i.qh,{path:"statistics",element:(0,z.jsx)(ns,{children:(0,z.jsx)(xe,{children:(0,z.jsx)(Vr,{})})})}),(0,z.jsx)(i.qh,{path:"profile",element:(0,z.jsx)(ns,{children:(0,z.jsx)(xe,{children:(0,z.jsx)(Hr,{})})})}),(0,z.jsx)(i.qh,{path:"settings",element:(0,z.jsx)(ns,{children:(0,z.jsx)(xe,{children:(0,z.jsx)(is,{})})})}),(0,z.jsx)(i.qh,{path:"admin-users",element:(0,z.jsx)(ns,{requiredPermission:{resource:"admins",action:"read"},children:(0,z.jsx)(xe,{children:(0,z.jsx)(rs,{})})})}),(0,z.jsx)(i.qh,{path:"",element:(0,z.jsx)(i.C5,{to:"/admin/dashboard",replace:!0})}),(0,z.jsx)(i.qh,{path:"*",element:(0,z.jsx)(i.C5,{to:"/admin/dashboard",replace:!0})})]})}},63338:(e,r,s)=>{s.d(r,{A:()=>i});const t=s(29246).A.create({baseURL:"https://restapi-3jza.onrender.com"});t.interceptors.request.use((e=>{e.data instanceof FormData||(e.headers["Content-Type"]="application/json");const r=localStorage.getItem("token");return r&&(e.headers.Authorization=`Bearer ${r}`),e}),(e=>Promise.reject(e))),t.interceptors.response.use((e=>e),(e=>(e.response&&401===e.response.status&&(localStorage.removeItem("token"),window.location.href="/admin/login"),Promise.reject(e))));new Map;const i=t}}]);